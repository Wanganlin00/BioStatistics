[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "应用医学统计学",
    "section": "",
    "text": "1 参考资料\n\n回归、主成分分析（Principal component analysis）、聚类：R in action 3rd、 ISLR\n医学研究中的生存数据建模（4e）\nt-Distributed Stochastic Neighbor Embedding (t-SNE)、R-tSNE\nUniform Manifold Approximation and Projection (UMAP)\nModern Statistics for Modern Biology\ntidymodels\nISLR with tidymodels",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>参考资料</span>"
    ]
  },
  {
    "objectID": "data_science.html",
    "href": "data_science.html",
    "title": "数据科学",
    "section": "",
    "text": "R Data Science Notes\nPython Data Science Notes",
    "crumbs": [
      "数据科学"
    ]
  },
  {
    "objectID": "statistical_description.html",
    "href": "statistical_description.html",
    "title": "\n2  统计描述\n",
    "section": "",
    "text": "3 统计描述\nCodemtcars$mpg\n#&gt;  [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4\n#&gt; [16] 10.4 14.7 32.4 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7\n#&gt; [31] 15.0 21.4",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#集中趋势和离散程度",
    "href": "statistical_description.html#集中趋势和离散程度",
    "title": "\n2  统计描述\n",
    "section": "\n3.1 集中趋势和离散程度",
    "text": "3.1 集中趋势和离散程度\n\nCodemean(mtcars$mpg)     #算术均数\n#&gt; [1] 20.09062\n# 几何均数 G=^n^√X1X2...Xn\nmedian(mtcars$mpg)   #中位数\n#&gt; [1] 19.2\nquantile(mtcars$mpg,probs = c(0,0.1,0.25,0.5,0.75,1))     #分位数\n#&gt;     0%    10%    25%    50%    75%   100% \n#&gt; 10.400 14.340 15.425 19.200 22.800 33.900\n\n\n\nrange(mtcars$mpg)  # 值域\n#&gt; [1] 10.4 33.9\ndiff(range(mtcars$mpg) )  # 极差\n#&gt; [1] 23.5\nIQR(mtcars$mpg)      # 四分位数间距\n#&gt; [1] 7.375\nsd(mtcars$mpg)       #标准差\n#&gt; [1] 6.026948\nvar(mtcars$mpg)      #方差\n#&gt; [1] 36.3241\nCV=sd(mtcars$mpg)/mean(mtcars$mpg)*100  # 变异系数\npaste(CV,\"%\")\n#&gt; [1] \"29.9988081609661 %\"\n\n\n\nmad(mtcars$mpg,constant = 1.4826)      #绝对中位差 median absolute deviation\n#&gt; [1] 5.41149\n\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))\n#&gt; [1] 3.65\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))*1.4826\n#&gt; [1] 5.41149\n\n\n为了达到渐进正态一致性，mad() 的计算乘了一个比例因子constant=1.4826。",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#偏度和峰度",
    "href": "statistical_description.html#偏度和峰度",
    "title": "\n2  统计描述\n",
    "section": "\n3.2 偏度和峰度",
    "text": "3.2 偏度和峰度\n\nterm\n\n1偏度（Skewness）的计算公式：\n\nS = \\frac{n}{(n-1)(n-2)} \\sum_{i=1}^{n} \\left( \\frac{X_i-\\overline{X}}{SD} \\right)^3 ]\n2 峰度（Kurtosis）的计算公式：\n\nK = \\frac{n(n+1)}{(n-1)(n-2)(n-3)}  \\sum_{i=1}^{n} \\left( \\frac{X_i - \\overline{X}}{SD} \\right)^4  - \\frac{3(n-1)^2}{(n-2)(n-3)}\n\n\n\n\nCodeskewness &lt;- function(x,na.rm=TRUE){\n    if(na.rm) x &lt;- x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    sknewness = sum((x-μ)^3/SD^3)*n/((n-1)*(n-2))\n    return(sknewness=sknewness)\n}\nskewness(c(21.4,5.4,23.5,21.4,44.3,14.9))\n#&gt; [1] 0.9345253\n\nkurtosis&lt;-function(x,na.rm=TRUE){\n    if(na.rm) x&lt;-x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    kurtosis=sum((x-μ)^4/SD^4)*n*(n+1)/((n-1)*(n-2)*(n-3))-(3*(n-1)^2)/((n-2)*(n-3))\n    return(kurtosis=kurtosis)\n}\n\nkurtosis(c(21.4,5.4,23.5,21.4,44.3,14.9))\n#&gt; [1] 2.225567",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#频数表和列联表",
    "href": "statistical_description.html#频数表和列联表",
    "title": "\n2  统计描述\n",
    "section": "\n3.3 频数表和列联表",
    "text": "3.3 频数表和列联表\n\nCodedata(gss_cat)  #因子数据集\nhead(gss_cat)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmarital\nage\nrace\nrincome\npartyid\nrelig\ndenom\ntvhours\n\n\n\n2000\nNever married\n26\nWhite\n$8000 to 9999\nInd,near rep\nProtestant\nSouthern baptist\n12\n\n\n2000\nDivorced\n48\nWhite\n$8000 to 9999\nNot str republican\nProtestant\nBaptist-dk which\nNA\n\n\n2000\nWidowed\n67\nWhite\nNot applicable\nIndependent\nProtestant\nNo denomination\n2\n\n\n2000\nNever married\n39\nWhite\nNot applicable\nInd,near rep\nOrthodox-christian\nNot applicable\n4\n\n\n2000\nDivorced\n25\nWhite\nNot applicable\nNot str democrat\nNone\nNot applicable\n1\n\n\n2000\nMarried\n25\nWhite\n$20000 - 24999\nStrong democrat\nProtestant\nSouthern baptist\nNA\n\n\n\n\n\n\n\nCodetable(gss_cat$marital,gss_cat$race)\n#&gt;                \n#&gt;                 Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\ntbl &lt;- xtabs(~marital+race,data = gss_cat)\ntbl\n#&gt;                race\n#&gt; marital         Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\n\n\n\nCodeprop.table(tbl)          #各单元格比例\n#&gt;                race\n#&gt; marital                Other        Black        White Not applicable\n#&gt;   No answer     9.309687e-05 9.309687e-05 6.051296e-04   0.000000e+00\n#&gt;   Never married 2.946516e-02 6.074571e-02 1.618955e-01   0.000000e+00\n#&gt;   Separated     5.120328e-03 9.123493e-03 2.034167e-02   0.000000e+00\n#&gt;   Divorced      9.868268e-03 2.304147e-02 1.245636e-01   0.000000e+00\n#&gt;   Widowed       3.258390e-03 1.219569e-02 6.865894e-02   0.000000e+00\n#&gt;   Married       4.338314e-02 4.045059e-02 3.870968e-01   0.000000e+00\nprop.table(tbl,margin = 1)        #行比例 \n#&gt;                race\n#&gt; marital              Other      Black      White Not applicable\n#&gt;   No answer     0.11764706 0.11764706 0.76470588     0.00000000\n#&gt;   Never married 0.11687592 0.24095273 0.64217134     0.00000000\n#&gt;   Separated     0.14804845 0.26379542 0.58815612     0.00000000\n#&gt;   Divorced      0.06266627 0.14631983 0.79101389     0.00000000\n#&gt;   Widowed       0.03873824 0.14499170 0.81627006     0.00000000\n#&gt;   Married       0.09212217 0.08589503 0.82198280     0.00000000\nmargin.table(x=tbl,margin = 2)      #列和\n#&gt; race\n#&gt;          Other          Black          White Not applicable \n#&gt;           1959           3129          16395              0\n\n \naddmargins(tbl)          #添加行和、列和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable   Sum\n#&gt;   No answer         2     2    13              0    17\n#&gt;   Never married   633  1305  3478              0  5416\n#&gt;   Separated       110   196   437              0   743\n#&gt;   Divorced        212   495  2676              0  3383\n#&gt;   Widowed          70   262  1475              0  1807\n#&gt;   Married         932   869  8316              0 10117\n#&gt;   Sum            1959  3129 16395              0 21483\naddmargins(tbl,1)        #添加列和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\n#&gt;   Sum            1959  3129 16395              0\naddmargins(tbl,2)        #添加行和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable   Sum\n#&gt;   No answer         2     2    13              0    17\n#&gt;   Never married   633  1305  3478              0  5416\n#&gt;   Separated       110   196   437              0   743\n#&gt;   Divorced        212   495  2676              0  3383\n#&gt;   Widowed          70   262  1475              0  1807\n#&gt;   Married         932   869  8316              0 10117\naddmargins(prop.table(tbl,1))\n#&gt;                race\n#&gt; marital              Other      Black      White Not applicable        Sum\n#&gt;   No answer     0.11764706 0.11764706 0.76470588     0.00000000 1.00000000\n#&gt;   Never married 0.11687592 0.24095273 0.64217134     0.00000000 1.00000000\n#&gt;   Separated     0.14804845 0.26379542 0.58815612     0.00000000 1.00000000\n#&gt;   Divorced      0.06266627 0.14631983 0.79101389     0.00000000 1.00000000\n#&gt;   Widowed       0.03873824 0.14499170 0.81627006     0.00000000 1.00000000\n#&gt;   Married       0.09212217 0.08589503 0.82198280     0.00000000 1.00000000\n#&gt;   Sum           0.57609812 0.99960178 4.42430011     0.00000000 6.00000000\n\nftable(tbl)   # \"平铺式\"列联表\n#&gt;               race Other Black White Not applicable\n#&gt; marital                                            \n#&gt; No answer              2     2    13              0\n#&gt; Never married        633  1305  3478              0\n#&gt; Separated            110   196   437              0\n#&gt; Divorced             212   495  2676              0\n#&gt; Widowed               70   262  1475              0\n#&gt; Married              932   869  8316              0",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#独立性检验分类变量",
    "href": "statistical_description.html#独立性检验分类变量",
    "title": "\n2  统计描述\n",
    "section": "\n3.4 独立性检验（分类变量）",
    "text": "3.4 独立性检验（分类变量）\n独立性：无关联或非线性关联\n\nCodeM &lt;- as.table(rbind(c(762, 327, 468), c(484, 239, 477)))\ndimnames(M) &lt;- list(gender = c(\"F\", \"M\"),\n                    party = c(\"Democrat\",\"Independent\", \"Republican\"))\nM\n#&gt;       party\n#&gt; gender Democrat Independent Republican\n#&gt;      F      762         327        468\n#&gt;      M      484         239        477\n#   1. 卡方检验\nchisq &lt;- chisq.test(M)\nchisq$parameter # degrees of freedom\n#&gt; df \n#&gt;  2\n\n#   2. Fisher精确检验   Fisher's exact test to test independence of rows and columns in contingency table\nfisher.test(M)\n#&gt; \n#&gt;  Fisher's Exact Test for Count Data\n#&gt; \n#&gt; data:  M\n#&gt; p-value = 3.027e-07\n#&gt; alternative hypothesis: two.sided\n\n\nRabbits &lt;-\narray(c(0, 0, 6, 5,\n        3, 0, 3, 6,\n        6, 2, 0, 4,\n        5, 6, 1, 0,\n        2, 5, 0, 0),\n      dim = c(2, 2, 5),\n      dimnames = list(\n          Delay = c(\"None\", \"1.5h\"),\n          Response = c(\"Cured\", \"Died\"),\n          Penicillin.Level = c(\"1/8\", \"1/4\", \"1/2\", \"1\", \"4\")))\nRabbits\n#&gt; , , Penicillin.Level = 1/8\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     0    6\n#&gt;   1.5h     0    5\n#&gt; \n#&gt; , , Penicillin.Level = 1/4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     3    3\n#&gt;   1.5h     0    6\n#&gt; \n#&gt; , , Penicillin.Level = 1/2\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     6    0\n#&gt;   1.5h     2    4\n#&gt; \n#&gt; , , Penicillin.Level = 1\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     5    1\n#&gt;   1.5h     6    0\n#&gt; \n#&gt; , , Penicillin.Level = 4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     2    0\n#&gt;   1.5h     5    0\n#   3. Cochran-Mantel-Haenszel 卡方检验  两个变量在第三个变量的每一水平下是否独立\nmantelhaen.test(Rabbits)\n#&gt; \n#&gt;  Mantel-Haenszel chi-squared test with continuity correction\n#&gt; \n#&gt; data:  Rabbits\n#&gt; Mantel-Haenszel X-squared = 3.9286, df = 1, p-value = 0.04747\n#&gt; alternative hypothesis: true common odds ratio is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;   1.026713 47.725133\n#&gt; sample estimates:\n#&gt; common odds ratio \n#&gt;                 7",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#相关性检验定量变量",
    "href": "statistical_description.html#相关性检验定量变量",
    "title": "\n2  统计描述\n",
    "section": "\n3.5 相关性检验（定量变量）",
    "text": "3.5 相关性检验（定量变量）\n相关性：线性关联\n\nCodestates &lt;- state.x77[,1:6]\ncov(states)    # 协方差矩阵\n#&gt;               Population      Income   Illiteracy     Life Exp      Murder\n#&gt; Population 19931683.7588 571229.7796  292.8679592 -407.8424612 5663.523714\n#&gt; Income       571229.7796 377573.3061 -163.7020408  280.6631837 -521.894286\n#&gt; Illiteracy      292.8680   -163.7020    0.3715306   -0.4815122    1.581776\n#&gt; Life Exp       -407.8425    280.6632   -0.4815122    1.8020204   -3.869480\n#&gt; Murder         5663.5237   -521.8943    1.5817755   -3.8694804   13.627465\n#&gt; HS Grad       -3551.5096   3076.7690   -3.2354694    6.3126849  -14.549616\n#&gt;                 HS Grad\n#&gt; Population -3551.509551\n#&gt; Income      3076.768980\n#&gt; Illiteracy    -3.235469\n#&gt; Life Exp       6.312685\n#&gt; Murder       -14.549616\n#&gt; HS Grad       65.237894\n\n\n\n3.5.0.1 相关系数\n\nCode# Pearson's 积差相关系数\ncor(states,use = \"everything\",method=\"pearson\") # default\n#&gt;             Population     Income Illiteracy    Life Exp     Murder     HS Grad\n#&gt; Population  1.00000000  0.2082276  0.1076224 -0.06805195  0.3436428 -0.09848975\n#&gt; Income      0.20822756  1.0000000 -0.4370752  0.34025534 -0.2300776  0.61993232\n#&gt; Illiteracy  0.10762237 -0.4370752  1.0000000 -0.58847793  0.7029752 -0.65718861\n#&gt; Life Exp   -0.06805195  0.3402553 -0.5884779  1.00000000 -0.7808458  0.58221620\n#&gt; Murder      0.34364275 -0.2300776  0.7029752 -0.78084575  1.0000000 -0.48797102\n#&gt; HS Grad    -0.09848975  0.6199323 -0.6571886  0.58221620 -0.4879710  1.00000000\n\n# Spearman's rank相关系数\ncor(states,method = \"spearman\")\n#&gt;            Population     Income Illiteracy   Life Exp     Murder    HS Grad\n#&gt; Population  1.0000000  0.1246098  0.3130496 -0.1040171  0.3457401 -0.3833649\n#&gt; Income      0.1246098  1.0000000 -0.3145948  0.3241050 -0.2174623  0.5104809\n#&gt; Illiteracy  0.3130496 -0.3145948  1.0000000 -0.5553735  0.6723592 -0.6545396\n#&gt; Life Exp   -0.1040171  0.3241050 -0.5553735  1.0000000 -0.7802406  0.5239410\n#&gt; Murder      0.3457401 -0.2174623  0.6723592 -0.7802406  1.0000000 -0.4367330\n#&gt; HS Grad    -0.3833649  0.5104809 -0.6545396  0.5239410 -0.4367330  1.0000000\n\n# Kendall's tau相关系数\ncor(states,method = \"kendall\")\n#&gt;             Population      Income Illiteracy    Life Exp     Murder    HS Grad\n#&gt; Population  1.00000000  0.08408163  0.2123063 -0.06865555  0.2364983 -0.2353905\n#&gt; Income      0.08408163  1.00000000 -0.1970811  0.21904389 -0.1448450  0.3579896\n#&gt; Illiteracy  0.21230629 -0.19708113  1.0000000 -0.42852098  0.5155359 -0.5047401\n#&gt; Life Exp   -0.06865555  0.21904389 -0.4285210  1.00000000 -0.5997547  0.3952537\n#&gt; Murder      0.23649826 -0.14484495  0.5155359 -0.59975465  1.0000000 -0.2884066\n#&gt; HS Grad    -0.23539045  0.35798964 -0.5047401  0.39525368 -0.2884066  1.0000000\n\n\n\n3.5.0.2 相关图（correlogram）\n?sec-correlogram\n\n3.5.0.3 显著性检验\n\nCodecor.test(state.x77[,\"Income\"],state.x77[,\"Illiteracy\"])\n#&gt; \n#&gt;  Pearson's product-moment correlation\n#&gt; \n#&gt; data:  state.x77[, \"Income\"] and state.x77[, \"Illiteracy\"]\n#&gt; t = -3.3668, df = 48, p-value = 0.001505\n#&gt; alternative hypothesis: true correlation is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  -0.6378257 -0.1807128\n#&gt; sample estimates:\n#&gt;        cor \n#&gt; -0.4370752\n\n\npsych包corr.test() 计算相关矩阵和显著性水平\n多分格（polychoric）相关系数、多系列（polyserial）相关系数\n\n3.5.0.4 偏相关系数\n在控制其他变量的条件下，分析两个定量变量之间的相关关系\nggm包pcor() , pcor.test()",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#数据可视化",
    "href": "statistical_description.html#数据可视化",
    "title": "\n2  统计描述\n",
    "section": "\n3.6 数据可视化",
    "text": "3.6 数据可视化\nbase_graphics.qmd\nggplot2_graphics.qmd",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "statistical_description.html#footnotes",
    "href": "statistical_description.html#footnotes",
    "title": "\n2  统计描述\n",
    "section": "",
    "text": "WPS Excel↩︎\nWPS Excel↩︎",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>统计描述</span>"
    ]
  },
  {
    "objectID": "SurvivalAnalysis.html",
    "href": "SurvivalAnalysis.html",
    "title": "3  生存分析",
    "section": "",
    "text": "3.1 Survival analysis\n医学研究中的生存数据建模",
    "crumbs": [
      "生存分析",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>生存分析</span>"
    ]
  }
]
[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "医学与生物统计学",
    "section": "",
    "text": "参考资料\n\nApplied Medical Statistics\n回归、主成分分析（Principal component analysis）、聚类：R in action 3rd、 ISLR\n医学研究中的生存数据建模（4e）\nt-Distributed Stochastic Neighbor Embedding (t-SNE)、R-tSNE\nUniform Manifold Approximation and Projection (UMAP)\nModern Statistics for Modern Biology\ntidymodels\nISLR with tidymodels",
    "crumbs": [
      "参考资料"
    ]
  },
  {
    "objectID": "data_science.html",
    "href": "data_science.html",
    "title": "数据科学",
    "section": "",
    "text": "推荐\nR Notes\nPython Data Science Notes",
    "crumbs": [
      "数据科学"
    ]
  },
  {
    "objectID": "descriptive_statistics.html",
    "href": "descriptive_statistics.html",
    "title": "\n1  描述性统计学\n",
    "section": "",
    "text": "1.1 数据类型",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据类型",
    "href": "descriptive_statistics.html#数据类型",
    "title": "\n1  描述性统计学\n",
    "section": "",
    "text": "定量数据（数字数据）\n\n连续数据\n离散数据\n\n\n\n定性数据（分类数据）\n\n无序分类数据\n有序分类数据",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#频数表和频率分布直方图",
    "href": "descriptive_statistics.html#频数表和频率分布直方图",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.2 频数表和频率分布直方图",
    "text": "1.2 频数表和频率分布直方图\n极差 \\(R=X_{max}-X_{min}\\) ， 组数\\(k\\)（\\(5-15\\)），组别（\\(interval\\)），频数\\(count\\)，频率\\(\\frac{count}{n} \\times 100\\%\\)",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据特征",
    "href": "descriptive_statistics.html#数据特征",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.3 数据特征",
    "text": "1.3 数据特征\n\nCodehead(mtcars$mpg)\n#&gt; [1] 21.0 21.0 22.8 21.4 18.7 18.1\n\n\n\n1.3.1 集中趋势\n\nCode# 集中趋势\n\nmean(mtcars$mpg)     #算术平均数\n#&gt; [1] 20.09062\nmedian(mtcars$mpg)   #中位数\n#&gt; [1] 19.2\n\n\n\n1.3.2 离散程度\n\nCode# 离散程度\nrange(mtcars$mpg)  # 值域\n#&gt; [1] 10.4 33.9\ndiff(range(mtcars$mpg) )  # 极差\n#&gt; [1] 23.5\n\nquantile(mtcars$mpg,probs = c(0,0.1,0.25,0.5,0.75,1))     #分位数\n#&gt;     0%    10%    25%    50%    75%   100% \n#&gt; 10.400 14.340 15.425 19.200 22.800 33.900\nIQR(mtcars$mpg)      # 四分位数间距\n#&gt; [1] 7.375\n\nsd(mtcars$mpg)       #标准差\n#&gt; [1] 6.026948\nvar(mtcars$mpg)      #方差\n#&gt; [1] 36.3241\n\nCV &lt;- function(x,na.rm=TRUE){   # 变异系数\n    if(na.rm) x &lt;- x[!is.na(x)]\n    CV=sd(x)/mean(x)*100\n    paste(CV,\"%\",sep = \"\")\n}\nCV(mtcars$mpg)\n#&gt; [1] \"29.9988081609661%\"\n\nmad(mtcars$mpg,constant = 1.4826)      #绝对中位差 median absolute deviation\n#&gt; [1] 5.41149\n# 为了达到渐进正态一致性，`mad()` 的计算乘了一个比例因子`constant=1.4826`。\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))\n#&gt; [1] 3.65\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))*1.4826\n#&gt; [1] 5.41149\n\n\n\n1.3.3 分布形状\n\n偏度（Skewness）\n\n表示随机变量概率分布的不对称性。\nhttps://www.macroption.com/skewness-formula/\n三阶中心矩。方差即二阶中心矩。\n\\[\n    Skew(X) =  \\frac{E(X_i-E(X))^3}{Var(X)^{\\frac{3}{2}}}\\\\ =E  [(\\frac{X_i-\\mu}{\\sigma})^3]\\\\= \\frac{1}{n} \\sum_{i=1}^{n} [ (\\frac{X_i-\\mu}{\\sigma} )^3]\n\\]\n偏度的取值范围： \\((-\\infty,+\\infty)\\)\n\nSkew＜0，负偏态分布；左长尾\nSkew=0，数据相对均匀的分布在均值两侧；\nSkew＞0，正偏态分布。右长尾\n\n\n\n\nCodex &lt;- c(1,2,3,5)\ns &lt;- psych::describeBy(x=x,group = NULL)\ns$skew\n#&gt; [1] 0.2823139\n\nskewness &lt;- function(x,na.rm=TRUE){\n    if(na.rm) x &lt;- x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    sknewness = mean(((x-μ)/SD)^3)\n    return(sknewness=sknewness)\n}\nskewness(x)\n#&gt; [1] 0.2823139\n\n\n\n峰度（Kurtosis）\n\n表示随机变量概率分布的尖峭程度。四阶中心矩与方差平方的比值。\nhttps://www.macroption.com/kurtosis-formula/\n超值峰度 excess kurtosis ：四阶中心矩与方差平方的比值减3。\nhttps://www.macroption.com/excess-kurtosis/\n\\[\nKurt(X) =  \\frac{E(X_i-E(X))^4}{Var(X)^{2}}-3\\\\= E  [(\\frac{X_i-\\mu}{\\sigma})^4] - 3\\\\= \\frac{1}{n} \\sum_{i=1}^{n} [ (\\frac{X_i-\\mu}{\\sigma} )^4]-3\n\\]\n峰度的取值范围：\\([1,+\\infty)\\)\n超值峰度的取值范围：\\([-2,+\\infty)\\)\n\n超值峰度＜0，数据分布与正态分布相比较为平坦；\n超值峰度=0，正态分布；\n超值峰度＞0，数据分布与正态分布相比较为陡峭。\n\n\n\n\nCodes$kurtosis\n#&gt; [1] -1.961786\n\nkurtosis&lt;-function(x,na.rm=TRUE){\n    if(na.rm) x&lt;-x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    kurtosis= mean(((x-μ)/SD)^4)-3\n    return(kurtosis=kurtosis)\n}\nkurtosis(x)\n#&gt; [1] -1.961786\n\n\n\n1.3.4 统计摘要\n\nCodesummary(mtcars$mpg)\n#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#&gt;   10.40   15.43   19.20   20.09   22.80   33.90\npsych::describeBy(mtcars$mpg,group = mtcars$am)\n#&gt; \n#&gt;  Descriptive statistics by group \n#&gt; group: 0\n#&gt;    vars  n  mean   sd median trimmed  mad  min  max range skew kurtosis   se\n#&gt; X1    1 19 17.15 3.83   17.3   17.12 3.11 10.4 24.4    14 0.01     -0.8 0.88\n#&gt; ------------------------------------------------------------ \n#&gt; group: 1\n#&gt;    vars  n  mean   sd median trimmed  mad min  max range skew kurtosis   se\n#&gt; X1    1 13 24.39 6.17   22.8   24.38 6.67  15 33.9  18.9 0.05    -1.46 1.71",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#统计表格",
    "href": "descriptive_statistics.html#统计表格",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.4 统计表格",
    "text": "1.4 统计表格\n\nCodeoptions(digits = 2)\nhead(mtcars)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmpg\ncyl\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\nMazda RX4\n21\n6\n160\n110\n3.9\n2.6\n16\n0\n1\n4\n4\n\n\nMazda RX4 Wag\n21\n6\n160\n110\n3.9\n2.9\n17\n0\n1\n4\n4\n\n\nDatsun 710\n23\n4\n108\n93\n3.8\n2.3\n19\n1\n1\n4\n1\n\n\nHornet 4 Drive\n21\n6\n258\n110\n3.1\n3.2\n19\n1\n0\n3\n1\n\n\nHornet Sportabout\n19\n8\n360\n175\n3.1\n3.4\n17\n0\n0\n3\n2\n\n\nValiant\n18\n6\n225\n105\n2.8\n3.5\n20\n1\n0\n3\n1\n\n\n\n\n\nCode\ntbl1 &lt;- tableone::CreateTableOne(vars = colnames(mtcars),\n                                 data = mtcars,\n                                 factorVars = c(\"cyl\"), # 分类\n                                 strata = c(\"am\"),  #分层\n                                 )\ntbl1\n#&gt;                   Stratified by am\n#&gt;                    0               1              p      test\n#&gt;   n                    19              13                    \n#&gt;   mpg (mean (SD))   17.15 (3.83)    24.39 (6.17)  &lt;0.001     \n#&gt;   cyl (%)                                          0.013     \n#&gt;      4                  3 (15.8)        8 (61.5)             \n#&gt;      6                  4 (21.1)        3 (23.1)             \n#&gt;      8                 12 (63.2)        2 (15.4)             \n#&gt;   disp (mean (SD)) 290.38 (110.17) 143.53 (87.20) &lt;0.001     \n#&gt;   hp (mean (SD))   160.26 (53.91)  126.85 (84.06)  0.180     \n#&gt;   drat (mean (SD))   3.29 (0.39)     4.05 (0.36)  &lt;0.001     \n#&gt;   wt (mean (SD))     3.77 (0.78)     2.41 (0.62)  &lt;0.001     \n#&gt;   qsec (mean (SD))  18.18 (1.75)    17.36 (1.79)   0.206     \n#&gt;   vs (mean (SD))     0.37 (0.50)     0.54 (0.52)   0.357     \n#&gt;   am (mean (SD))     0.00 (0.00)     1.00 (0.00)  &lt;0.001     \n#&gt;   gear (mean (SD))   3.21 (0.42)     4.38 (0.51)  &lt;0.001     \n#&gt;   carb (mean (SD))   2.74 (1.15)     2.92 (2.18)   0.754",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据可视化",
    "href": "descriptive_statistics.html#数据可视化",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.5 数据可视化",
    "text": "1.5 数据可视化\nR Notes\n\nbase_graphics\nggplot2_graphics",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "normality_independence_correlation.html",
    "href": "normality_independence_correlation.html",
    "title": "\n2  正态性检验\n",
    "section": "",
    "text": "2.0.0.1 正态分布\nCodenorm &lt;- function(xlim = c(-Inf,+Inf)){\n  ggplot() + xlim(xlim) +\n    geom_function(fun = dnorm, args = list(mean = 0, sd = 1), color=\"red\")+\n        scale_y_continuous(limits = c(0,1))+\n    geom_function(fun = pnorm,color=\"blue\")\n}\nnorm(c(-10,10))         # Area Under the Curve (AUC) = 1",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>正态性检验</span>"
    ]
  },
  {
    "objectID": "normality_independence_correlation.html#分类变量的列联表和独立性检验",
    "href": "normality_independence_correlation.html#分类变量的列联表和独立性检验",
    "title": "\n2  正态性检验\n",
    "section": "\n2.1 分类变量的列联表和独立性检验",
    "text": "2.1 分类变量的列联表和独立性检验\n\n2.1.1 列联表\n\nCodedata(gss_cat)  #因子数据集\nhead(gss_cat)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmarital\nage\nrace\nrincome\npartyid\nrelig\ndenom\ntvhours\n\n\n\n2000\nNever married\n26\nWhite\n$8000 to 9999\nInd,near rep\nProtestant\nSouthern baptist\n12\n\n\n2000\nDivorced\n48\nWhite\n$8000 to 9999\nNot str republican\nProtestant\nBaptist-dk which\nNA\n\n\n2000\nWidowed\n67\nWhite\nNot applicable\nIndependent\nProtestant\nNo denomination\n2\n\n\n2000\nNever married\n39\nWhite\nNot applicable\nInd,near rep\nOrthodox-christian\nNot applicable\n4\n\n\n2000\nDivorced\n25\nWhite\nNot applicable\nNot str democrat\nNone\nNot applicable\n1\n\n\n2000\nMarried\n25\nWhite\n$20000 - 24999\nStrong democrat\nProtestant\nSouthern baptist\nNA\n\n\n\n\n\nCodetable(gss_cat$marital,gss_cat$race)\n#&gt;                \n#&gt;                 Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\ntbl &lt;- xtabs(formula = ~marital+race,data = gss_cat,subset =NULL)\ntbl\n#&gt;                race\n#&gt; marital         Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\n\n\n\nCodeprop.table(tbl)          #各单元格比例\n#&gt;                race\n#&gt; marital                Other        Black        White Not applicable\n#&gt;   No answer     9.309687e-05 9.309687e-05 6.051296e-04   0.000000e+00\n#&gt;   Never married 2.946516e-02 6.074571e-02 1.618955e-01   0.000000e+00\n#&gt;   Separated     5.120328e-03 9.123493e-03 2.034167e-02   0.000000e+00\n#&gt;   Divorced      9.868268e-03 2.304147e-02 1.245636e-01   0.000000e+00\n#&gt;   Widowed       3.258390e-03 1.219569e-02 6.865894e-02   0.000000e+00\n#&gt;   Married       4.338314e-02 4.045059e-02 3.870968e-01   0.000000e+00\nprop.table(tbl,margin = 1)        #行比例 \n#&gt;                race\n#&gt; marital              Other      Black      White Not applicable\n#&gt;   No answer     0.11764706 0.11764706 0.76470588     0.00000000\n#&gt;   Never married 0.11687592 0.24095273 0.64217134     0.00000000\n#&gt;   Separated     0.14804845 0.26379542 0.58815612     0.00000000\n#&gt;   Divorced      0.06266627 0.14631983 0.79101389     0.00000000\n#&gt;   Widowed       0.03873824 0.14499170 0.81627006     0.00000000\n#&gt;   Married       0.09212217 0.08589503 0.82198280     0.00000000\n\n# 边际\nmargin.table(x=tbl,margin = 2)      #列和\n#&gt; race\n#&gt;          Other          Black          White Not applicable \n#&gt;           1959           3129          16395              0\naddmargins(tbl)          #添加行和、列和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable   Sum\n#&gt;   No answer         2     2    13              0    17\n#&gt;   Never married   633  1305  3478              0  5416\n#&gt;   Separated       110   196   437              0   743\n#&gt;   Divorced        212   495  2676              0  3383\n#&gt;   Widowed          70   262  1475              0  1807\n#&gt;   Married         932   869  8316              0 10117\n#&gt;   Sum            1959  3129 16395              0 21483\naddmargins(tbl,1)        #添加列和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\n#&gt;   Sum            1959  3129 16395              0\naddmargins(tbl,2)        #添加行和\n#&gt;                race\n#&gt; marital         Other Black White Not applicable   Sum\n#&gt;   No answer         2     2    13              0    17\n#&gt;   Never married   633  1305  3478              0  5416\n#&gt;   Separated       110   196   437              0   743\n#&gt;   Divorced        212   495  2676              0  3383\n#&gt;   Widowed          70   262  1475              0  1807\n#&gt;   Married         932   869  8316              0 10117\naddmargins(prop.table(tbl,1))\n#&gt;                race\n#&gt; marital              Other      Black      White Not applicable        Sum\n#&gt;   No answer     0.11764706 0.11764706 0.76470588     0.00000000 1.00000000\n#&gt;   Never married 0.11687592 0.24095273 0.64217134     0.00000000 1.00000000\n#&gt;   Separated     0.14804845 0.26379542 0.58815612     0.00000000 1.00000000\n#&gt;   Divorced      0.06266627 0.14631983 0.79101389     0.00000000 1.00000000\n#&gt;   Widowed       0.03873824 0.14499170 0.81627006     0.00000000 1.00000000\n#&gt;   Married       0.09212217 0.08589503 0.82198280     0.00000000 1.00000000\n#&gt;   Sum           0.57609812 0.99960178 4.42430011     0.00000000 6.00000000\n\nftable(tbl)   # \"平铺式\"列联表\n#&gt;               race Other Black White Not applicable\n#&gt; marital                                            \n#&gt; No answer              2     2    13              0\n#&gt; Never married        633  1305  3478              0\n#&gt; Separated            110   196   437              0\n#&gt; Divorced             212   495  2676              0\n#&gt; Widowed               70   262  1475              0\n#&gt; Married              932   869  8316              0\n\n\n\n2.1.2 独立性检验\n独立性：判断两个或多个分类变量之间是否存在关联或取值互不影响，分析联合概率分布是否可以分解为各自概率分布的乘积。\n\n2.1.2.1 \\(\\chi^2\\) 独立性检验\n\nCodeM &lt;- as.table(rbind(c(86, 29), c(44, 30)))\ndimnames(M) &lt;- list(gender = c(\"F\", \"M\"),\n                    smoking = c(\"Yes\",\"No\"))\nM\n#&gt;       smoking\n#&gt; gender Yes No\n#&gt;      F  86 29\n#&gt;      M  44 30\n\nchisq &lt;- chisq.test(M)\nchisq\n#&gt; \n#&gt;  Pearson's Chi-squared test with Yates' continuity correction\n#&gt; \n#&gt; data:  M\n#&gt; X-squared = 4.2359, df = 1, p-value = 0.03958\nchisq$expected  # 期望频数\n#&gt;       smoking\n#&gt; gender      Yes       No\n#&gt;      F 79.10053 35.89947\n#&gt;      M 50.89947 23.10053\nchisq$parameter # degrees of freedom\n#&gt; df \n#&gt;  1\n\n#对于频数表中每个单元格的期望频数都比较大（大于 5）的大样本，correct设为 FALSE,不进行连续校正\nchisq2 &lt;- chisq.test(M,correct = FALSE) \nchisq2\n#&gt; \n#&gt;  Pearson's Chi-squared test\n#&gt; \n#&gt; data:  M\n#&gt; X-squared = 4.9237, df = 1, p-value = 0.02649\n\n\n\n2.1.2.2 Fisher精确检验\n　　如果观察总记录数 n 小于 40，或者频数表里的某个期望频数很小（小于 1） ，则需要使 用 Fisher 精确概率检验。\n\nCode# Fisher's exact test to test independence of rows and columns in contingency table\nfisher.test(M)\n#&gt; \n#&gt;  Fisher's Exact Test for Count Data\n#&gt; \n#&gt; data:  M\n#&gt; p-value = 0.03618\n#&gt; alternative hypothesis: true odds ratio is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;  1.028780 3.964904\n#&gt; sample estimates:\n#&gt; odds ratio \n#&gt;   2.014137\n\n\n\n2.1.2.3 相对危险度与优势比\n　　相对危险度 （Relative Risk，RR），是指暴露组人群 的发病率与非暴露组人群的发病率之比。RR 用于反映暴露因素与结局事件的关联程度， 其 取值范围为 0 到无穷大。数值为 1 时，表明暴露因素与结局事件无关联；小于 1 时，表 明暴露因素导致结局事件的发生率降低；大于 1 时，表明暴露因素导致结局事件的发生 率增加。\n　　优势比（Odds Ratio，OR），是指暴露组中病例与非病例人数的比值除以非暴露组中病例与非病例人数的比值。　　OR 的取值范围也为 0 到无穷大。如果 OR 值大于 1 ，说明该暴露因素更 容易导致结果事件发生，或者说该因素是一个危险因素；小于 1 ，则说明该暴露因素更不 容易导致结果事件发生，或者说该因素是一个保护因素。\n\n2.1.2.4 Cochran-Mantel-Haenszel \\(\\chi^2\\) 检验\n　　两个变量的关联有可能受到第三个变量的影响，因此我们有必要检验两个分类变量在 调整（控制）第三个变量的情况下是否独立。 Cochran-Mantel-Haenszel χ 2 检验常用于探索 变量间的混杂因素。其零假设是：两个分类变量在第三个变量的每一层都是条件独立的。函数 mantelhaen.test( ) 可以用来进行该检验。\n\nCodeRabbits &lt;-\narray(c(0, 0, 6, 5,\n        3, 0, 3, 6,\n        6, 2, 0, 4,\n        5, 6, 1, 0,\n        2, 5, 0, 0),\n      dim = c(2, 2, 5),\n      dimnames = list(\n          Delay = c(\"None\", \"1.5h\"),\n          Response = c(\"Cured\", \"Died\"),\n          Penicillin.Level = c(\"1/8\", \"1/4\", \"1/2\", \"1\", \"4\")))\nRabbits\n#&gt; , , Penicillin.Level = 1/8\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     0    6\n#&gt;   1.5h     0    5\n#&gt; \n#&gt; , , Penicillin.Level = 1/4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     3    3\n#&gt;   1.5h     0    6\n#&gt; \n#&gt; , , Penicillin.Level = 1/2\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     6    0\n#&gt;   1.5h     2    4\n#&gt; \n#&gt; , , Penicillin.Level = 1\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     5    1\n#&gt;   1.5h     6    0\n#&gt; \n#&gt; , , Penicillin.Level = 4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     2    0\n#&gt;   1.5h     5    0\n\nmantelhaen.test(Rabbits)\n#&gt; \n#&gt;  Mantel-Haenszel chi-squared test with continuity correction\n#&gt; \n#&gt; data:  Rabbits\n#&gt; Mantel-Haenszel X-squared = 3.9286, df = 1, p-value = 0.04747\n#&gt; alternative hypothesis: true common odds ratio is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;   1.026713 47.725133\n#&gt; sample estimates:\n#&gt; common odds ratio \n#&gt;                 7\n\n\n\n2.1.2.5 配对列联表的 χ 2 检验\n　　医学科研实践中经常遇到配对设计的计数资料，例如两种检验方法、诊断方法结果的 比较。其特点是对每个研究对象分别用两种方法处理，然后观察两种处理方法的某两分类 变量的计数结果。对于这种数据，我们也可以整理成列联表的形式，但是不能用前述的 χ 2独立性检验，需进行 Mcnemar 检验。\n\nCode#　　某实验室分别用免疫荧光法和乳胶凝集法对 58 名疑似系统性红斑狼疮患者血清中抗 核抗体进行测定\nresult&lt;- matrix(c(11, 2, 12, 33), nrow = 2,dimnames = list(c(\"+\",\"-\"),c(\"+\",\"-\")))\nresult\n#&gt;    +  -\n#&gt; + 11 12\n#&gt; -  2 33\n\n#　　对于配对四格表，如果样本量较小（不一致的结果的总数小于 40 ） ，则需要进行连续性校正。\nmcnemar.test(result,correct = TRUE)\n#&gt; \n#&gt;  McNemar's Chi-squared test with continuity correction\n#&gt; \n#&gt; data:  result\n#&gt; McNemar's chi-squared = 5.7857, df = 1, p-value = 0.01616",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>正态性检验</span>"
    ]
  },
  {
    "objectID": "normality_independence_correlation.html#分类变量间的相关性",
    "href": "normality_independence_correlation.html#分类变量间的相关性",
    "title": "\n2  正态性检验\n",
    "section": "\n2.2 分类变量间的相关性",
    "text": "2.2 分类变量间的相关性\n　　如果独立性检验的结果表明两个变量之间不独立，那么很自然地我们就想量化它们之间相关性的强弱。 vcd 包里的函数 assocstats( )可以用来计算列联表的 Phi 系数、列联系数和 Cramer’s V 系数。其中， Phi 系数只适用于四格表。 　　 　　\n\n2.2.1 相关系数 　　\n\nCodelibrary(vcd)\nmytable &lt;- table(Arthritis$Treatment, Arthritis$Improved)\nassocstats(mytable)\n#&gt;                     X^2 df  P(&gt; X^2)\n#&gt; Likelihood Ratio 13.530  2 0.0011536\n#&gt; Pearson          13.055  2 0.0014626\n#&gt; \n#&gt; Phi-Coefficient   : NA \n#&gt; Contingency Coeff.: 0.367 \n#&gt; Cramer's V        : 0.394\n\n\n　　对于配对列联表，可以计算一致性指标 Kappa 统计量。 epiDisplay 包里的函数 kap( )可以用于计算一致性的比例以及 Kappa 统计量的值 　　 　　\n\nCodemy.matrix &lt;- matrix(c(11, 2, 12, 33), nrow = 2)\nepiDisplay::kap(my.matrix)\n#&gt; \n#&gt;  Table for calculation of kappa\n#&gt;    A  B\n#&gt; A 11 12\n#&gt; B  2 33\n#&gt; \n#&gt; Observed agreement = 75.86 % \n#&gt; Expected agreement = 55.71 % \n#&gt; Kappa = 0.455 \n#&gt; Standard error = 0.121 , Z = 3.762 , P value = &lt; 0.001 \n#&gt; \n\n\n　　共 58 个对象，每一对象用两种检测方法检测，其中 1 个对象的两种检测结果都为阳 性， 33 个对象的两种检测结果都是阴性，所以总的一致性为 (1 + 33)/58 ≈ 75.86% 。为了解释期望一致性和 Kappa 值的含义，先计算各个单元格的期望频数。 　　 　　\n\nCodechisq.test(my.matrix)$expected\n#&gt;          [,1]     [,2]\n#&gt; [1,] 5.155172 17.84483\n#&gt; [2,] 7.844828 27.15517\n\n\n　　对角线上的这两个单元格对应的期望频数分别约为 5.15 和 27.15 ，因此期望一致性为 (5.155 + 27.15)/58 ≈ 55.71% 。期望一致性是假定两种方法的检测结果都是完全随机的情况下的 一致性。也就是说，即使两种检测方法都毫无作用，平均也能达到 5.71% 的一致性。 Kappa 统 计量是超出随机的一致性的部分占最大可能超出随机的一致性的比例。在本例中，前者为 75.86% − 55.71% ， 后者为 100% − 55.71% 。 因此， Kappa 值为 (75.86 − 5.71)/(10 − 5.71) ≈ 0.45\n\n2.2.2 马赛克图\n　　马赛克图中的矩形面积正比于多维列联表中单元格的频率 　　\n\nCodemosaic(~ Sex + Treatment + Improved, data = Arthritis)",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>正态性检验</span>"
    ]
  },
  {
    "objectID": "normality_independence_correlation.html#连续变量的相关性检验",
    "href": "normality_independence_correlation.html#连续变量的相关性检验",
    "title": "\n2  正态性检验\n",
    "section": "\n2.3 连续变量的相关性检验",
    "text": "2.3 连续变量的相关性检验\n相关性：判断两个变量之间的线性关系强度和方向，无论是否独立。\n协方差（或相关系数）为零，不相关，不存在线性关系，但可能存在非线性关系。\n\nCodedf &lt;- mpg[,c(3,8,9)]\ncov(df)    # 协方差矩阵\n#&gt;           displ      cty       hwy\n#&gt; displ  1.669158 -4.39069 -5.893111\n#&gt; cty   -4.390690 18.11307 24.225432\n#&gt; hwy   -5.893111 24.22543 35.457779\n\n\n\n2.3.0.1 相关系数\n相关系数的取值范围： \\([-1,1]\\)\n\nCode# Pearson's 积差相关系数 　　一般要求两个连续变量都服从正态分布\ncor(df,use = \"everything\",method=\"pearson\") # default\n#&gt;           displ        cty        hwy\n#&gt; displ  1.000000 -0.7985240 -0.7660200\n#&gt; cty   -0.798524  1.0000000  0.9559159\n#&gt; hwy   -0.766020  0.9559159  1.0000000\n\n# Spearman's rank相关系数  　　非参数\ncor(df,method = \"spearman\")\n#&gt;            displ        cty        hwy\n#&gt; displ  1.0000000 -0.8809049 -0.8266576\n#&gt; cty   -0.8809049  1.0000000  0.9542104\n#&gt; hwy   -0.8266576  0.9542104  1.0000000\n\n# Kendall's tau相关系数  　　非参数\ncor(df,method = \"kendall\")\n#&gt;            displ        cty        hwy\n#&gt; displ  1.0000000 -0.7210828 -0.6536974\n#&gt; cty   -0.7210828  1.0000000  0.8628045\n#&gt; hwy   -0.6536974  0.8628045  1.0000000\n\n\n\n2.3.0.2 相关图（correlogram）\n?sec-correlogram\n\nCodeggcorrplot::ggcorrplot(\n    corr = cor(df,use = \"everything\",method=\"pearson\") ,\n)\n\n\n\n\n\n\n\n\n2.3.0.3 相关系数的假设检验\n　　零假设为变量之间不相关（即两个总体的相关系数为 0 ） 。函数 cor.test( ) 可用于对相关系数进行显著性检 验。\n\nCodecor.test(df$displ,df$hwy)\n#&gt; \n#&gt;  Pearson's product-moment correlation\n#&gt; \n#&gt; data:  df$displ and df$hwy\n#&gt; t = -18.151, df = 232, p-value &lt; 2.2e-16\n#&gt; alternative hypothesis: true correlation is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  -0.8142727 -0.7072539\n#&gt; sample estimates:\n#&gt;      cor \n#&gt; -0.76602\n\n\npsych包corr.test() 计算相关系数矩阵和显著性检验\n\nCodepsych::corr.test(df)\n#&gt; Call:psych::corr.test(x = df)\n#&gt; Correlation matrix \n#&gt;       displ   cty   hwy\n#&gt; displ  1.00 -0.80 -0.77\n#&gt; cty   -0.80  1.00  0.96\n#&gt; hwy   -0.77  0.96  1.00\n#&gt; Sample Size \n#&gt; [1] 234\n#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) \n#&gt;       displ cty hwy\n#&gt; displ     0   0   0\n#&gt; cty       0   0   0\n#&gt; hwy       0   0   0\n#&gt; \n#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option\n\nprint(psych::corr.test(df), short = FALSE)\n#&gt; Call:psych::corr.test(x = df)\n#&gt; Correlation matrix \n#&gt;       displ   cty   hwy\n#&gt; displ  1.00 -0.80 -0.77\n#&gt; cty   -0.80  1.00  0.96\n#&gt; hwy   -0.77  0.96  1.00\n#&gt; Sample Size \n#&gt; [1] 234\n#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) \n#&gt;       displ cty hwy\n#&gt; displ     0   0   0\n#&gt; cty       0   0   0\n#&gt; hwy       0   0   0\n#&gt; \n#&gt;  Confidence intervals based upon normal theory.  To get bootstrapped values, try cor.ci\n#&gt;           raw.lower raw.r raw.upper raw.p lower.adj upper.adj\n#&gt; displ-cty     -0.84 -0.80     -0.75     0     -0.85     -0.74\n#&gt; displ-hwy     -0.81 -0.77     -0.71     0     -0.81     -0.71\n#&gt; cty-hwy        0.94  0.96      0.97     0      0.94      0.97",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>正态性检验</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html",
    "href": "probability_fundamentals.html",
    "title": "3  概率论",
    "section": "",
    "text": "3.1 基础概念\n样本点（sample point）是每一次随机试验的结果，用 \\(\\omega\\) 表示。\n样本空间（sample space）是所有样本点的集合，用\\(\\Omega=\\{\\omega_{i};i=0,1,2,... \\}\\)表示。\n随机事件（random event）是一组样本点（\\(\\Omega\\)的子集）的集合，用大写字母 \\(A,B,C,...\\)表示。\n一个样本点的集合称为简单事件（simple event），用 \\(\\Omega=\\{\\omega\\}\\) 表示。\n若干个简单事件的集合称为混合事件（composite event）。全集 \\(\\Omega\\) 称为必然事件（deterministic event），空集（null set） \\(\\emptyset\\) 称为不可能事件（impossible event）。\n加法\n\\[\nP(A\\cup B)=P(A)+P(B)-P(A\\cap B)\n\\]\n条件概率\n\\[\nP(B|A)=\\frac{P(A\\cap B)}{P(A)}\n\\]\n乘法\n\\[\nP(A\\cap B)=P(A)\\times P(B|A)\n\\]\n独立事件（交集的概率等于各自概率的乘积）\n\\[ P(B|A)=P(B) \\ 或者\\  P(A)=0 \\]\n全概率公式（给定Ai发生，B的加权平均条件概率）\n\\[P(B)=\\sum_{i=1}^{n}P(A_i)P(B|A_i)\\]\n贝叶斯法则/逆概率公式（后验概率）\n\\[P(A_k |B)=\\frac{P(A_k)P(B|A_k)}{\\sum_{i=1}^{n}P(A_i)P(B|A_i)}\\]",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#基础概念",
    "href": "probability_fundamentals.html#基础概念",
    "title": "3  概率论",
    "section": "",
    "text": "包含关系（containment） ：Venn diagram\n\n\\(A\\subseteq B\\)\n\\(A\\supseteq B\\)\n\n并集（\\(A\\cup B\\)）\n交集（\\(A\\cap B\\)）\n补集（\\(\\bar A\\)）\n互斥事件 \\(A\\cap B=\\emptyset\\)\n互补事件 \\(A\\cap B=\\emptyset\\) 且 \\(A\\cup B=\\Omega\\)",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#离散型随机变量",
    "href": "probability_fundamentals.html#离散型随机变量",
    "title": "3  概率论",
    "section": "3.2 离散型随机变量",
    "text": "3.2 离散型随机变量\n概率分布列： \\(P(X=x_k)=p_k (k=1,2,…)\\)\n累计分布函数：\\(F(x) =P(X≤x)= \\sum_{x_k≤x}p_k\\)\n期望：\\(E(X)=\\sum_{k}x_k p_k(k=1,2,...)\\)\n方差：\\(Var(X)=\\sum_{k}x_k^2 p_k-\\mu^2\\)\n\n3.2.1 二项分布\n组合（combination）：\\(C_n^k =\\frac {n!}{k!(n-k)!}\\)\n概率质量函数（pmf）：\\(P(X=k)=p_k=C_n^k\\pi^k(1-\\pi)^{n-k} \\ (k=0,1,...,n)\\)\n\\[\nX\\sim B(n,\\pi)\n\\]\n其中n表示独立试验的次数，\\(\\pi\\) 表示成功概率。\n累计概率：至多k0次成功的概率——\\(P(X≤k_0)=\\sum_{k=0}^{k_0} p_k\\)\n至少k0次成功的概率——\\(P(X≥k_0)=\\sum_{k=k_0}^{n} p_k\\)\n期望：\\(E(X)=n\\pi\\)\n方差：\\(Var(X)=n\\pi(1-\\pi)\\)\n\n\n3.2.2 多项式分布\n概率：\\(P(X_1=n_1,...,X_i=n_i,...,X_k=n_k)=\\frac {n!}{n_1!...n_i!...n_k!}\\pi_1^{n_1}...\\pi_i^{n_i}...\\pi_k^{n_k}\\)\n\\[\nX \\sim M(n,\\pi_1,\\pi_2,...,\\pi_k)\n\\]\n其中\\(n=n_1+n_2+...+n_k\\) 表示独立试验的次数，\\(\\pi_k\\) 表示\\(k\\) 个互斥结果的成功概率。\n期望(\\(A_i 与 -A_i\\))：\\(\\mu_{A_i}=n\\pi_{A_i}\\)\n方差(\\(A_i 与 -A_i\\))：\\(\\sigma_{A_i}^2=n\\pi_{A_i}(1-\\pi_{A_i})\\)\n\n\n3.2.3 泊松分布\n概率： \\(P(X=k)=p_k=\\frac {\\lambda ^k}{k!}e^{-\\lambda} (\\lambda &gt; 0;k=0,1,…)\\)\n\\[\nX\\sim P(\\lambda)\n\\]\n其中\\(\\lambda\\) 表示单位时间/空间罕见事件发生的期望值。\n期望：\\(\\mu=\\lambda\\)\n方差：\\(\\sigma^2=\\lambda\\)\n\n3.2.3.1 二项分布近似泊松分布\n当\\(n(n≥100)\\)足够大，\\(\\pi(\\pi ≤0.01)\\) 足够小，二项分布的均值 \\(n\\pi\\) 与方差\\(n\\pi(1-\\pi)\\approx n\\pi\\) 近似相等，此时的二项分布近似\\(\\lambda=n\\pi\\) 的泊松分布。\n\\[\nP(X=k)=C_n^k \\pi^k(1-\\pi)^{n-k} \\approx \\frac{\\lambda ^k}{k!}e^{-\\lambda}\n\\]",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#连续型随机变量",
    "href": "probability_fundamentals.html#连续型随机变量",
    "title": "3  概率论",
    "section": "3.3 连续型随机变量",
    "text": "3.3 连续型随机变量\n概率：\\(P(a≤X≤b)=\\int_{a}^{b}f(x)dx\\)\n概率密度函数（pdf）：\\(f(x)\\)\n累计分布函数（cdf）：\\(F(x)=P(X≤x)=\\int_{-\\infty}^{x}f(t)dt\\)\n期望：\\(E(X)\\equiv\\mu =\\int_{-\\infty}^{+\\infty}xf(x)dx\\)\n方差：\\(\\sigma^2\\equiv E(X^2)-\\mu^2=\\int_{-\\infty}^{+\\infty}x^2f(x)dx-[\\int_{-\\infty}^{+\\infty}xf(x)dx]^2\\)\n\n3.3.1 正态分布\n概率密度函数（pdf）：\\(f(x)=\\frac {1}{\\sqrt{2\\pi}\\sigma}e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}}（-\\infty ＜x ＜+\\infty）\\)\n\\[\nX \\sim N(\\mu,\\sigma^2)\n\\]\n累计分布函数（cdf）:\\(F(x)=P(X≤x)=\\int_{-\\infty}^{x}f(t)dt=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\int_{-\\infty}^{x}e^{-\\frac{(t-\\mu)^2}{2\\sigma^2}}dt\\ (-\\infty＜x＜+\\infty)\\)\n\n\n3.3.2 标准正态分布\n\\[\nZ=\\frac {X-\\mu}{\\sigma} \\sim \\ N(0,1)\n\\]\npdf：\\(\\varphi (z)=\\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{z^2}{2}} (-\\infty＜z＜+\\infty)\\)\ncdf：\\(\\Phi(z)=P(Z≤z)=\\int_{-\\infty}^{z}\\varphi (\\nu )d\\nu =\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{z}e^{-\\frac{\\nu^2}{2}}dt\\ (-\\infty＜z＜+\\infty)\\)\n\n\n3.3.3 正态性的描述\n\n3.3.3.1 直方图/茎叶图\n直方图：钟形分布（bell-shaped distribution）\n茎叶图（Stem-and-Leaf Plot）\n\n\n3.3.3.2 P-P图/Q-Q图\nP-P图是累计相对频率的观测值（x轴）与理论值（y轴）的散点图；\nQ-Q图是分位数的观测值（x轴）与理论值（y轴）的散点图。\n\n\n3.3.3.3 矩量法（Moment Method）\n偏度=0 且 超值峰度=0\n\n\n\n3.3.4 二项分布近似正态分布\n当\\(n\\pi(1-\\pi)≥5 且X\\sim B(n,\\pi)\\)时，\\(P(a≤X≤b)近似等于X\\sim N(n\\pi,n\\pi(1-\\pi))在区间(a-0.5,b+0.5)上的曲线下面积\\)。\n\\[\nZ=\\frac{x-\\mu}{\\sigma}=\\frac{x-n\\pi}{\\sqrt{n\\pi(1-\\pi)}}\n\\]\n\n\n3.3.5 泊松分布近似正态分布\n当\\(\\lambda≥10 且X\\sim P(\\lambda)\\)时，\\(P(a≤X≤b)近似等于X\\sim N(\\lambda,\\lambda)在区间(a-0.5,b+0.5)上的曲线下面积\\)。\n\\[\nZ=\\frac{x-\\mu}{\\sigma}=\\frac{x-\\lambda}{\\sqrt{\\lambda}}\n\\]\n\n\n3.3.6 医学参考区间\n\n\n3.3.7",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论</span>"
    ]
  },
  {
    "objectID": "SamplingDistribution.html",
    "href": "SamplingDistribution.html",
    "title": "4  抽样分布",
    "section": "",
    "text": "统计量（statistic）\n\n假设\\(\\hat\\theta=\\hat\\theta(X_1,X_2,...,X_n)\\) 是关于随机样本\\(X_1,X_2,...,X_n\\) 的函数，且不依赖任何未知的总体参数\\(\\theta\\) ，则\\(\\hat\\theta\\) 称为统计量（statistic）。\n\n\n样本均值 \\(\\hat \\theta_1=\\bar X=\\frac{\\sum_{i=1}^{n}{X_i}}{n}\\) 和样本方差 \\(\\hat \\theta_2=S^2=\\frac{\\sum_{i=1}^{n} (X_i-\\bar X)^2}{n-1}\\) 是统计量（statistics）。\n\n4.0.1 均值（mean）的抽样分布\n假设 \\(X_1,X_2,...,X_n\\)是来自均值为\\(μ\\)，有限方差为\\(σ^2\\)的总体为 \\(X\\)的一组样本量为n的随机样本。\\(\\bar X\\) 的抽样分布是指从总体 \\(X\\)中选择的样本量为\\(n\\)的所有可能样本的 \\(\\bar x\\)值（\\(\\bar x=\\sum_{i}x_i/n\\)）的分布。\n\n4.0.1.1 σ2 已知的正态分布\n\\[\n\\bar X \\sim N(μ,\\frac{σ^2}{n})\n\\]\n标准化\\(\\bar X\\)\n\\[\nZ=\\frac{\\bar X-\\mu}{\\sigma_{\\bar X}}=\\frac{\\bar X-\\mu}{\\sigma /\\sqrt n} \\sim N(0,1)\n\\]\n均值的标准误 \\(\\sigma _{\\bar X} =\\frac {\\sigma}{\\sqrt n}\\) 可以用 \\(S _{\\bar X} =\\frac {S}{\\sqrt n}\\) 估计。\n\n\n4.0.1.2 大样本量的非正态分布\n\n中心极限定理（central limit theorem）\n\n当样本量n足够大时，即使随机样本并非来自正态分布总体，\\(\\bar X\\) 的抽样分布也会近似正态分布。\n\\[ \\bar X \\dot{\\sim}  N(μ,\\frac{σ^2}{n}) \\]\n\n\n\n\n4.0.1.3 σ2 未知的正态分布\n\\[ t=\\frac{\\bar X-\\mu}{S_{\\bar X}}=\\frac{\\bar X-\\mu}{S /\\sqrt n} \\sim t(\\nu) \\]\n其中自由度（degrees of freedom）\\(\\nu=n-1\\) 。当 \\(\\nu \\to +\\infty 时,t\\sim N(0,1)\\) 。\n\n\n\n4.0.2 方差（variance）的抽样分布\n假设 \\(X_1,X_2,...,X_n\\)是来自均值为\\(μ\\)，有限方差为\\(σ^2\\)的总体为 \\(X\\)的一组样本量为n的随机样本。列出样本量为\\(n\\)的所有可能随机样本。\n\n4.0.2.1 \\(\\chi^2\\)分布\n\\[\n\\frac {(n-1)S^2}{\\sigma^2}\\sim \\chi^2(\\nu)\n\\]\n其中自由度（degrees of freedom）\\(\\nu=n-1\\) 。\n\n\n\n4.0.3 率（rate）抽样分布——分类数据\n假设 \\(X\\sim B(n,\\pi)\\) ，一组样本量为n的随机样本。列出样本量为\\(n\\)的所有可能随机样本。\n样本率\\(p=X/n\\) ，则\\(E(p)=E(X/n)=\\pi,Var(p)=Var(X/n)=\\pi(1-\\pi)/n\\)\n率的标准误 \\(\\sigma_p =\\sqrt{\\frac{\\pi(1-\\pi)}{n}}\\) 可以用 \\(S _p =\\sqrt{\\frac{p(1-p)}{n}}\\) 估计。\n当\\(n\\pi(1-\\pi)≥5 且X\\sim B(n,\\pi)\\)时，率的抽样分布 \\(p\\dot\\sim N(\\pi,\\frac{\\pi(1-\\pi)}{n})\\)",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html",
    "href": "ParameterEstimation.html",
    "title": "5  参数估计",
    "section": "",
    "text": "5.1 一个总体的参数估计",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html#一个总体的参数估计",
    "href": "ParameterEstimation.html#一个总体的参数估计",
    "title": "5  参数估计",
    "section": "",
    "text": "5.1.0.1 点估计\n假设 \\(\\theta\\)是总体\\(X\\)的一个参数，\\(\\hat\\theta=\\hat\\theta(X_1,X_2,...,X_n)\\)是代表\\(\\theta\\)的数值估计的一个统计量。任何可能的\\(\\hat\\theta\\)称为\\(\\theta\\)的点估计。\n\n无偏性（unbiasedness）\n如果\\(E(\\hat\\theta)=\\theta\\),就说参数\\(\\theta\\)的一个估计\\(\\hat\\theta\\)是无偏的。\n\\[\n\\bar X=\\sum_{i=1}^{n}X_i/n\n\\]\n\\[\nE(\\bar X)=\\frac{1}{n}E(\\sum_{i=1}^{n}X_i)=\\frac{n\\mu}{\\mu}=\\mu\n\\]\n所以样本均值\\(\\bar X\\)是总体均值\\(\\mu\\)的一个无偏估计。\n\\[\nS^2=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar X)^2\n\\]\n\\[\nE(S^2)=E(\\frac{n}{n-1}S_n^2)=\\frac{n}{n-1}E(S_n^2)=\\frac{n}{n-1}E(\\frac {1}{n}\\sum_{i=1}^{n}(X_i-\\bar X)^2\\\\=\\frac{n}{n-1}\\times\\frac{n-1}{n}\\sigma^2=\\sigma^2\n\\] 所以样本方差\\(S^2\\)是总体方差\\(\\sigma^2\\)的一个无偏估计。\n\n\n最小方差无偏估计（MVUE）\n\\(\\hat\\theta\\)无偏且最小方差\n\n\n一致性（consistency）\n对于任意一个\\(\\epsilon＞0\\) ，如果 \\[\\lim_{n\\to \\infty}P(|\\hat\\theta_n-\\theta|＜\\epsilon)=1\\] 那么\\(\\hat\\theta_n\\)是总体参数\\(\\theta\\)的一个一致估计。\n\n\n\n5.1.1 区间估计\n\n5.1.1.1 均值的区间估计\n\n\\(\\sigma^2\\)已知的正态分布\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(\\bar X\\sim N(\\mu,\\frac{\\sigma^2}{n})\\),变换\\(Z=\\frac{\\bar X-\\mu}{\\sigma/\\sqrt n}\\sim N(0,1)\\)。\n对于给定的\\(\\alpha\\)，称\\(z_{\\alpha/2}\\)和\\(z_{1-\\alpha/2}\\)为临界值（critical value）。当\\(Z\\)分布是对称的，\\(z_{\\alpha/2}=-z_{1-\\alpha/2}\\)。\n区间估计的置信水平（confidence level）：\\(1-\\alpha\\)\n总体均值的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt n}\\)\n\n\n大样本量的非正态分布\n\\(X_1,X_2,...,X_n\\)是来自非正态分布的随机样本,当样本量足够大时，\\(\\bar X \\dot{\\sim} N(μ,\\frac{σ^2}{n})\\), 变换\\(Z=\\frac{\\bar X-\\mu}{S/\\sqrt n}\\dot\\sim N(0,1)\\)。\n总体均值的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\frac{S}{\\sqrt n}\\)\n\n\n\\(\\sigma^2\\)未知的正态分布\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(t=\\frac{\\bar X-\\mu}{S /\\sqrt n} \\sim t(\\nu),\\nu=n-1\\)。\n对于给定的\\(\\alpha\\)，称\\(t_{\\nu,\\alpha/2}\\)和\\(t_{\\nu,1-\\alpha/2}\\)为临界值（critical value）。\\(t_{\\alpha/2}=-t_{1-\\alpha/2}\\)。\n总体均值的置信区间（confidence interval）：\\([\\bar X- t_{\\nu,1-\\alpha/2}\\frac{S}{\\sqrt n},\\bar X+ t_{\\nu,1-\\alpha/2}\\frac{S}{\\sqrt n}]\\)\n\n\n\n5.1.1.2 方差的区间估计\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(\\frac {(n-1)S^2}{\\sigma^2}\\sim \\chi^2(\\nu),\\nu=n-1\\)\n对于给定的\\(\\alpha\\)，称\\(\\chi^2_{\\nu,\\alpha/2}\\)和\\(\\chi^2_{\\nu,1-\\alpha/2}\\)为临界值（critical value）。\n区间估计的置信水平（confidence level）：\\(1-\\alpha\\)\n总体方差的置信区间（confidence interval）：\\([\\frac {(n-1)S^2}{\\chi^2_{\\nu,1-\\alpha/2}},\\frac {(n-1)S^2}{\\chi^2_{\\nu,\\alpha/2}}]\\)\n\n\n5.1.1.3 率的区间估计\n\\(X_1,X_2,...,X_n\\)是来自\\(B(n,\\pi)\\)的随机样本, 当\\(n\\pi(1-\\pi)≥5\\)时，率的抽样分布 \\(p\\dot\\sim N(\\pi,\\frac{\\pi(1-\\pi)}{n})\\)，则变换\\(Z=\\frac{p-\\pi}{\\sqrt{p(1-p)/n}}\\dot\\sim N(0,1)\\)。\n总体率的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\sqrt{\\frac{p(1-p)}{n}}\\)",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html#两个总体的参数估计",
    "href": "ParameterEstimation.html#两个总体的参数估计",
    "title": "5  参数估计",
    "section": "5.2 两个总体的参数估计",
    "text": "5.2 两个总体的参数估计\n\n5.2.1 均值差异的估计\n\n5.2.1.1 点估计\n\\(E(\\bar X_1-\\bar X_2)=\\mu_1-\\mu_2\\),\\(Var(\\bar X_1-\\bar X_2)=\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}\\)\n统计量\\(\\bar X_1-\\bar X_2\\)是\\(\\mu_1-\\mu_2\\)的MVUE。\n\n\n5.2.1.2 区间估计\n\n正态分布或大样本量非正态分布\n当\\(n_1＞30\\ \\&\\ n_2＞30\\)时，\n\\[\n(\\bar X_1-\\bar X_2) \\dot\\sim N(\\mu_1-\\mu_2,\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2})\n\\] 标准化变换 \\[\nZ=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}}}\\dot\\sim N(0,1)\n\\] 用样本方差代替总体方差，总体均值的置信区间（confidence interval）：\\(\\bar X_1-\\bar X_2 \\pm z_{1-\\alpha/2}\\sqrt{\\frac{S^2_1}{n_1}+\\frac{S^2_2}{n_2}}\\)\n\n\n方差相等的未知正态分布\n\\[\nt(\\nu),v=n_1+n_2-2\n\\]\n\n\n方差不等的未知正态分布\n\\[\nt(\\nu '),v'=\\frac{(\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2})^2}{\\frac{(\\frac{S_1^2}{n_1})^2}{n_1-1}+\\frac{(\\frac{S_2^2}{n_2})^2}{n_2-1}}(舍入到最近整数)\n\\]\n\n\n\n\n5.2.2 方差之比的估计\n\n5.2.2.1 点估计\n\\(X_1\\sim N(\\mu_1,\\sigma_1^2)\\)\n\\(X_2\\sim N(\\mu_2,\\sigma_2^2)\\)\n统计量\\(S_1^2/S_2^2\\)是\\(\\sigma_1^2/\\sigma_2^2\\)的MVUE。\n\n\n5.2.2.2 区间估计\n\\[\nF=\\frac{\\frac {(n_1-1)S_1^2}{\\sigma_1^2}/(n_1-1)}{\\frac {(n_2-1)S_2^2}{\\sigma_2^2}/(n_2-1)}=(\\frac{S_1^2}{S_2^2})(\\frac{\\sigma_2^2}{\\sigma_1^2})\\sim F(\\nu_1,\\nu_2),\\nu_1=n_1-1,\\nu_2=n_2-1\n\\] 对于给定的\\(\\alpha\\)，称\\(F_{(\\nu_1,\\nu_2),\\alpha/2}\\)和\\(F_{(\\nu_1,\\nu_2),1-\\alpha/2}\\)为临界值（critical value）。\\(F_{(\\nu_1,\\nu_2),\\alpha/2}=\\frac{1}{F_{(\\nu_1,\\nu_2),1-\\alpha/2}}\\)\n总体方差的置信区间（confidence interval）：\\([\\frac{S_1^2}{S_2^2}\\times \\frac{1}{F_{(\\nu_1,\\nu_2),1-\\alpha/2}},\\frac{S_1^2}{S_2^2}\\times \\frac{1}{F_{(\\nu_1,\\nu_2),\\alpha/2}}]\\)\n\n\n\n5.2.3 率差异的估计\n\n5.2.3.1 点估计\n当\\(n_ip_i(1-p_i)≥5,(i=1,2)\\)时，\\(p_i\\dot\\sim N(\\pi_i,\\frac{\\pi_i(1-\\pi_i)}{n_i})\\)\n\\(E(p_1-p_2)=\\pi_1-\\pi_2\\)\n\\(Var(p_1-p_2)=\\frac{\\pi_1(1-\\pi_1)}{n_1}+\\frac{\\pi_2(1-\\pi_2)}{n_2}\\)\n统计量\\(p_1-p_2\\)是\\(\\pi_1-\\pi_2\\)的MVUE。\n\n\n5.2.3.2 区间估计\n\\[\n(p_1-p_2)\\dot\\sim N(\\pi_1-\\pi_2,\\frac{\\pi_1(1-\\pi_1)}{n_1}+\\frac{\\pi_2(1-\\pi_2)}{n_2})\n\\] 标准化变换 \\[\nZ=\\frac{(p_1-p_2)-(\\pi_1-\\pi_2)}{S_{p_1-p_2}}\\dot\\sim N(0,1)\n\\] 其中\\(S_{p_1-p_2}=\\sqrt{\\frac{p_1(1-p_1)}{n_1}+\\frac{p_2(1-p_2)}{n_2}}\\)",
    "crumbs": [
      "概率论",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html",
    "href": "hypothesis_testing.html",
    "title": "\n6  假设检验\n",
    "section": "",
    "text": "6.1 三段论",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#三段论",
    "href": "hypothesis_testing.html#三段论",
    "title": "\n6  假设检验\n",
    "section": "",
    "text": "建立假设和确定检验水平\n\nnull hypothesis H0\n\nalternative hypothesis H1\n\nα-拒绝域的概率\n\n\n选择检验方法和计算检验统计量\n\n\n\\(z\\)检验，\\(t\\)检验，\\(\\chi^2\\)检验，\\(F\\)检验，非参数检验等\n\n\n根据P值做出统计推断\n\np≤α，拒绝H0\n\np＞α，不拒绝H0",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#z检验",
    "href": "hypothesis_testing.html#z检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.2 \\(z\\)检验",
    "text": "6.2 \\(z\\)检验",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#t检验",
    "href": "hypothesis_testing.html#t检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.3 \\(t\\)检验",
    "text": "6.3 \\(t\\)检验\n\n6.3.0.1 单样本 t 检验\n\n它是一种参数检验，用于测试正态分布中样本的均值是否可以合理地为特定值。\n\nCodeset.seed(100)\nx &lt;- rnorm(50, mean = 10, sd = 0.5)\nt.test(x, mu=10) \n#&gt; \n#&gt;  One Sample t-test\n#&gt; \n#&gt; data:  x\n#&gt; t = 0.70372, df = 49, p-value = 0.4849\n#&gt; alternative hypothesis: true mean is not equal to 10\n#&gt; 95 percent confidence interval:\n#&gt;   9.924374 10.157135\n#&gt; sample estimates:\n#&gt; mean of x \n#&gt;  10.04075\n\n\n\nCode##两独立样本\nlibrary(MASS)\nt.test(Prob~So,data=UScrime)\n#&gt; \n#&gt;  Welch Two Sample t-test\n#&gt; \n#&gt; data:  Prob by So\n#&gt; t = -3.8954, df = 24.925, p-value = 0.0006506\n#&gt; alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  -0.03852569 -0.01187439\n#&gt; sample estimates:\n#&gt; mean in group 0 mean in group 1 \n#&gt;      0.03851265      0.06371269\nUScrime\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nM\nSo\nEd\nPo1\nPo2\nLF\nM.F\nPop\nNW\nU1\nU2\nGDP\nIneq\nProb\nTime\ny\n\n\n\n151\n1\n91\n58\n56\n510\n950\n33\n301\n108\n41\n394\n261\n0.084602\n26.2011\n791\n\n\n143\n0\n113\n103\n95\n583\n1012\n13\n102\n96\n36\n557\n194\n0.029599\n25.2999\n1635\n\n\n142\n1\n89\n45\n44\n533\n969\n18\n219\n94\n33\n318\n250\n0.083401\n24.3006\n578\n\n\n136\n0\n121\n149\n141\n577\n994\n157\n80\n102\n39\n673\n167\n0.015801\n29.9012\n1969\n\n\n141\n0\n121\n109\n101\n591\n985\n18\n30\n91\n20\n578\n174\n0.041399\n21.2998\n1234\n\n\n121\n0\n110\n118\n115\n547\n964\n25\n44\n84\n29\n689\n126\n0.034201\n20.9995\n682\n\n\n127\n1\n111\n82\n79\n519\n982\n4\n139\n97\n38\n620\n168\n0.042100\n20.6993\n963\n\n\n131\n1\n109\n115\n109\n542\n969\n50\n179\n79\n35\n472\n206\n0.040099\n24.5988\n1555\n\n\n157\n1\n90\n65\n62\n553\n955\n39\n286\n81\n28\n421\n239\n0.071697\n29.4001\n856\n\n\n140\n0\n118\n71\n68\n632\n1029\n7\n15\n100\n24\n526\n174\n0.044498\n19.5994\n705\n\n\n124\n0\n105\n121\n116\n580\n966\n101\n106\n77\n35\n657\n170\n0.016201\n41.6000\n1674\n\n\n134\n0\n108\n75\n71\n595\n972\n47\n59\n83\n31\n580\n172\n0.031201\n34.2984\n849\n\n\n128\n0\n113\n67\n60\n624\n972\n28\n10\n77\n25\n507\n206\n0.045302\n36.2993\n511\n\n\n135\n0\n117\n62\n61\n595\n986\n22\n46\n77\n27\n529\n190\n0.053200\n21.5010\n664\n\n\n152\n1\n87\n57\n53\n530\n986\n30\n72\n92\n43\n405\n264\n0.069100\n22.7008\n798\n\n\n142\n1\n88\n81\n77\n497\n956\n33\n321\n116\n47\n427\n247\n0.052099\n26.0991\n946\n\n\n143\n0\n110\n66\n63\n537\n977\n10\n6\n114\n35\n487\n166\n0.076299\n19.1002\n539\n\n\n135\n1\n104\n123\n115\n537\n978\n31\n170\n89\n34\n631\n165\n0.119804\n18.1996\n929\n\n\n130\n0\n116\n128\n128\n536\n934\n51\n24\n78\n34\n627\n135\n0.019099\n24.9008\n750\n\n\n125\n0\n108\n113\n105\n567\n985\n78\n94\n130\n58\n626\n166\n0.034801\n26.4010\n1225\n\n\n126\n0\n108\n74\n67\n602\n984\n34\n12\n102\n33\n557\n195\n0.022800\n37.5998\n742\n\n\n157\n1\n89\n47\n44\n512\n962\n22\n423\n97\n34\n288\n276\n0.089502\n37.0994\n439\n\n\n132\n0\n96\n87\n83\n564\n953\n43\n92\n83\n32\n513\n227\n0.030700\n25.1989\n1216\n\n\n131\n0\n116\n78\n73\n574\n1038\n7\n36\n142\n42\n540\n176\n0.041598\n17.6000\n968\n\n\n130\n0\n116\n63\n57\n641\n984\n14\n26\n70\n21\n486\n196\n0.069197\n21.9003\n523\n\n\n131\n0\n121\n160\n143\n631\n1071\n3\n77\n102\n41\n674\n152\n0.041698\n22.1005\n1993\n\n\n135\n0\n109\n69\n71\n540\n965\n6\n4\n80\n22\n564\n139\n0.036099\n28.4999\n342\n\n\n152\n0\n112\n82\n76\n571\n1018\n10\n79\n103\n28\n537\n215\n0.038201\n25.8006\n1216\n\n\n119\n0\n107\n166\n157\n521\n938\n168\n89\n92\n36\n637\n154\n0.023400\n36.7009\n1043\n\n\n166\n1\n89\n58\n54\n521\n973\n46\n254\n72\n26\n396\n237\n0.075298\n28.3011\n696\n\n\n140\n0\n93\n55\n54\n535\n1045\n6\n20\n135\n40\n453\n200\n0.041999\n21.7998\n373\n\n\n125\n0\n109\n90\n81\n586\n964\n97\n82\n105\n43\n617\n163\n0.042698\n30.9014\n754\n\n\n147\n1\n104\n63\n64\n560\n972\n23\n95\n76\n24\n462\n233\n0.049499\n25.5005\n1072\n\n\n126\n0\n118\n97\n97\n542\n990\n18\n21\n102\n35\n589\n166\n0.040799\n21.6997\n923\n\n\n123\n0\n102\n97\n87\n526\n948\n113\n76\n124\n50\n572\n158\n0.020700\n37.4011\n653\n\n\n150\n0\n100\n109\n98\n531\n964\n9\n24\n87\n38\n559\n153\n0.006900\n44.0004\n1272\n\n\n177\n1\n87\n58\n56\n638\n974\n24\n349\n76\n28\n382\n254\n0.045198\n31.6995\n831\n\n\n133\n0\n104\n51\n47\n599\n1024\n7\n40\n99\n27\n425\n225\n0.053998\n16.6999\n566\n\n\n149\n1\n88\n61\n54\n515\n953\n36\n165\n86\n35\n395\n251\n0.047099\n27.3004\n826\n\n\n145\n1\n104\n82\n74\n560\n981\n96\n126\n88\n31\n488\n228\n0.038801\n29.3004\n1151\n\n\n148\n0\n122\n72\n66\n601\n998\n9\n19\n84\n20\n590\n144\n0.025100\n30.0001\n880\n\n\n141\n0\n109\n56\n54\n523\n968\n4\n2\n107\n37\n489\n170\n0.088904\n12.1996\n542\n\n\n162\n1\n99\n75\n70\n522\n996\n40\n208\n73\n27\n496\n224\n0.054902\n31.9989\n823\n\n\n136\n0\n121\n95\n96\n574\n1012\n29\n36\n111\n37\n622\n162\n0.028100\n30.0001\n1030\n\n\n139\n1\n88\n46\n41\n480\n968\n19\n49\n135\n53\n457\n249\n0.056202\n32.5996\n455\n\n\n126\n0\n104\n106\n97\n599\n989\n40\n24\n78\n25\n593\n171\n0.046598\n16.6999\n508\n\n\n130\n0\n121\n90\n91\n623\n1049\n3\n22\n113\n40\n588\n160\n0.052802\n16.0997\n849\n\n\n\n\n\nCode##两非独立样本\nlibrary(MASS)\nsapply(UScrime[c(\"U1\",\"U2\")], function(x)(c(mean=mean(x),sd=sd(x))))\n#&gt;            U1       U2\n#&gt; mean 95.46809 33.97872\n#&gt; sd   18.02878  8.44545\nwith(UScrime,t.test(U1,U2,paired=TRUE))  #配对t检验\n#&gt; \n#&gt;  Paired t-test\n#&gt; \n#&gt; data:  U1 and U2\n#&gt; t = 32.407, df = 46, p-value &lt; 2.2e-16\n#&gt; alternative hypothesis: true mean difference is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  57.67003 65.30870\n#&gt; sample estimates:\n#&gt; mean difference \n#&gt;        61.48936",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#chi2检验",
    "href": "hypothesis_testing.html#chi2检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.4 \\(\\chi^2\\)检验",
    "text": "6.4 \\(\\chi^2\\)检验",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#f检验",
    "href": "hypothesis_testing.html#f检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.5 \\(F\\)检验",
    "text": "6.5 \\(F\\)检验\n\n6.5.1 Fisher F 检验\nFisher F 检验可用于检查两个样本是否具有相同的方差。或者，fligner.test（） 和 bartlett.test（） 可以用于相同的目的。",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#非参数检验",
    "href": "hypothesis_testing.html#非参数检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.6 非参数检验",
    "text": "6.6 非参数检验\n\n6.6.0.1 Wilcoxon Signed Rank Test\n\n在不假设正态分布时检验样本的平均值。Wilcoxon 符号秩检验可以替代 t 检验，尤其是当数据样本不假定服从正态分布时。它是一种非参数方法，用于测试估计值是否与其真实值不同。\n\nCodenumeric_vector &lt;- c(20, 29, 24, 19, 20, 22, 28, 23, 19, 19)\nwilcox.test(numeric_vector, mu=20, conf.int = TRUE)\n#&gt; \n#&gt;  Wilcoxon signed rank test with continuity correction\n#&gt; \n#&gt; data:  numeric_vector\n#&gt; V = 30, p-value = 0.1056\n#&gt; alternative hypothesis: true location is not equal to 20\n#&gt; 90 percent confidence interval:\n#&gt;  19.00006 25.99999\n#&gt; sample estimates:\n#&gt; (pseudo)median \n#&gt;       23.00002\n\n\n\n6.6.0.2 双样本 t 检验和 Wilcoxon rank sum 检验\nt.Test 和 Wilcoxon 秩检验都可用于比较 2 个样本的平均值。区别在于 t 检验假设被测试的样本是从正态分布中抽取的，而 Wilcoxon 的秩和检验则不然。\n\nCodex &lt;- c(0.80, 0.83, 1.89, 1.04, 1.45, 1.38, 1.91, 1.64, 0.73, 1.46)\ny &lt;- c(1.15, 0.88, 0.90, 0.74, 1.21)\n\nt.test(1:10, y = c(7:20)) \n#&gt; \n#&gt;  Welch Two Sample t-test\n#&gt; \n#&gt; data:  1:10 and c(7:20)\n#&gt; t = -5.4349, df = 21.982, p-value = 1.855e-05\n#&gt; alternative hypothesis: true difference in means is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  -11.052802  -4.947198\n#&gt; sample estimates:\n#&gt; mean of x mean of y \n#&gt;       5.5      13.5\nwilcox.test(x, y, alternative = \"g\") # g for greater\n#&gt; \n#&gt;  Wilcoxon rank sum exact test\n#&gt; \n#&gt; data:  x and y\n#&gt; W = 35, p-value = 0.1272\n#&gt; alternative hypothesis: true location shift is greater than 0\n\n# Use paired = TRUE for 1-to-1 comparison of observations.\nt.test(x, y, paired = TRUE) # when observations are paired, use 'paired' argument.\n#&gt; Error in complete.cases(x, y): not all arguments have the same length\nwilcox.test(x, y, paired = TRUE) # both x and y are assumed to have similar shapes\n#&gt; Error in wilcox.test.default(x, y, paired = TRUE): 'x' and 'y' must have the same length\n\n\n\nCode#Wilcoxon秩和检验  两组\nwith(UScrime,by(Prob,list(So=UScrime$So),median))\n#&gt; So: 0\n#&gt; [1] 0.038201\n#&gt; ------------------------------------------------------------ \n#&gt; So: 1\n#&gt; [1] 0.055552\nwilcox.test(Prob~So,data=UScrime)\n#&gt; \n#&gt;  Wilcoxon rank sum exact test\n#&gt; \n#&gt; data:  Prob by So\n#&gt; W = 81, p-value = 8.488e-05\n#&gt; alternative hypothesis: true location shift is not equal to 0\n#Wilcoxon符号秩和检验：非独立样本t检验的非参数替代方法\nsapply(UScrime[c(\"U1\",\"U2\")], median)\n#&gt; U1 U2 \n#&gt; 92 34\nwith(UScrime,wilcox.test(U1,U2,paired=T))\n#&gt; \n#&gt;  Wilcoxon signed rank test with continuity correction\n#&gt; \n#&gt; data:  U1 and U2\n#&gt; V = 1128, p-value = 2.464e-09\n#&gt; alternative hypothesis: true location shift is not equal to 0\n\n#多组独立样本    kruskal.test(y~A,data)\n\nstates&lt;-data.frame(state.region,state.x77)\nkruskal.test(Illiteracy~state.region,data=states)\n#&gt; \n#&gt;  Kruskal-Wallis rank sum test\n#&gt; \n#&gt; data:  Illiteracy by state.region\n#&gt; Kruskal-Wallis chi-squared = 22.672, df = 3, p-value = 4.726e-05\n#非参数多重成对比较\n #source(\"https://rkabacoff.com/RiA/wmc.R\")\nsource(\"wmc.R\")\nstates &lt;- data.frame(state.region, state.x77)\nwmc(Illiteracy ~ state.region, data=states, method=\"holm\") #Nonparametric multiple comparisons\n#&gt; Error in xtfrm.data.frame(x): cannot xtfrm data frames\n\n#多组互不独立   # Friedman's rank sum non-parametric test \nfriedman.test(y ~ A | B, data)\n#&gt; Error in model.frame.default(formula = y ~ A + B, data = data): 'data' must be a data.frame, environment, or list",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "SurvivalAnalysis.html",
    "href": "SurvivalAnalysis.html",
    "title": "7  生存分析",
    "section": "",
    "text": "7.1 Survival analysis\n医学研究中的生存数据建模",
    "crumbs": [
      "生存分析",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>生存分析</span>"
    ]
  }
]
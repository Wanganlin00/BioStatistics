[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "医学与生物统计学",
    "section": "",
    "text": "参考资料\n\nApplied Medical Statistics\n回归、主成分分析（Principal component analysis）、聚类：R in action 3rd、 ISLR\n医学研究中的生存数据建模（4e）\nt-Distributed Stochastic Neighbor Embedding (t-SNE)、R-tSNE\nUniform Manifold Approximation and Projection (UMAP)\nModern Statistics for Modern Biology\nhttps://www.tidymodels.org/",
    "crumbs": [
      "参考资料"
    ]
  },
  {
    "objectID": "data_science.html",
    "href": "data_science.html",
    "title": "数据科学",
    "section": "",
    "text": "推荐\nR Notes\nPython Data Science Notes",
    "crumbs": [
      "数据科学"
    ]
  },
  {
    "objectID": "descriptive_statistics.html",
    "href": "descriptive_statistics.html",
    "title": "\n1  描述性统计学\n",
    "section": "",
    "text": "1.1 数据类型",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据类型",
    "href": "descriptive_statistics.html#数据类型",
    "title": "\n1  描述性统计学\n",
    "section": "",
    "text": "定量数据（数字数据）\n\n连续数据\n离散数据\n\n\n\n定性数据（分类数据）\n\n无序分类数据\n有序分类数据",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#频数表和频率分布直方图",
    "href": "descriptive_statistics.html#频数表和频率分布直方图",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.2 频数表和频率分布直方图",
    "text": "1.2 频数表和频率分布直方图\n极差 \\(R=X_{max}-X_{min}\\) ， 组数\\(k\\)（\\(5-15\\)），组别（\\(interval\\)），频数\\(count\\)，频率\\(\\frac{count}{n} \\times 100\\%\\)",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据特征",
    "href": "descriptive_statistics.html#数据特征",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.3 数据特征",
    "text": "1.3 数据特征\n\nCodehead(mtcars$mpg)\n#&gt; [1] 21.0 21.0 22.8 21.4 18.7 18.1\n\n\n\n1.3.1 集中趋势\n\nCode# 集中趋势\n\nmean(mtcars$mpg)     #算术平均数\n#&gt; [1] 20.09062\nmedian(mtcars$mpg)   #中位数\n#&gt; [1] 19.2\n#众数 mode\n\n\n\n1.3.2 离散程度\n\nCode# 离散程度\nrange(mtcars$mpg)  # 值域\n#&gt; [1] 10.4 33.9\ndiff(range(mtcars$mpg) )  # 极差\n#&gt; [1] 23.5\n\nquantile(mtcars$mpg,probs = c(0,0.1,0.25,0.5,0.75,1))     #分位数\n#&gt;     0%    10%    25%    50%    75%   100% \n#&gt; 10.400 14.340 15.425 19.200 22.800 33.900\nIQR(mtcars$mpg)      # 四分位数间距\n#&gt; [1] 7.375\n\nsd(mtcars$mpg)       #标准差\n#&gt; [1] 6.026948\nvar(mtcars$mpg)      #方差\n#&gt; [1] 36.3241\n\nCV &lt;- function(x,na.rm=TRUE){   # 变异系数\n    if(na.rm) x &lt;- x[!is.na(x)]\n    CV=sd(x)/mean(x)*100\n    paste(CV,\"%\",sep = \"\")\n}\nCV(mtcars$mpg)\n#&gt; [1] \"29.9988081609661%\"\n\nmad(mtcars$mpg,constant = 1.4826)      #绝对中位差 median absolute deviation\n#&gt; [1] 5.41149\n# 为了达到渐进正态一致性，`mad()` 的计算乘了一个比例因子`constant=1.4826`。\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))\n#&gt; [1] 3.65\nmedian(abs(mtcars$mpg-median(mtcars$mpg)))*1.4826\n#&gt; [1] 5.41149\n\n\n\n1.3.3 分布形状\n\n偏度（Skewness）\n\n表示随机变量概率分布的不对称性。\nhttps://www.macroption.com/skewness-formula/\n三阶中心矩。方差即二阶中心矩。\n\\[\n    Skew(X) =  \\frac{E(X_i-E(X))^3}{Var(X)^{\\frac{3}{2}}}\\\\ =E  [(\\frac{X_i-\\mu}{\\sigma})^3]\\\\= \\frac{1}{n} \\sum_{i=1}^{n}  (\\frac{X_i-\\mu}{\\sigma} )^3\n\\]\n偏度的取值范围： \\((-\\infty,+\\infty)\\)\n\nSkew＜0，负偏态分布，左偏 = 尾部向左；\nSkew=0，数据相对均匀的分布在均值两侧；\nSkew＞0，正偏态分布，右偏 = 尾部向右。\n\n\n\n\nCodex &lt;- c(1,2,3,5)\ns &lt;- psych::describeBy(x=x,group = NULL)\ns$skew\n#&gt; [1] 0.2823139\n\nskewness &lt;- function(x,na.rm=TRUE){\n    if(na.rm) x &lt;- x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    sknewness = mean(((x-μ)/SD)^3)\n    return(sknewness=sknewness)\n}\nskewness(x)\n#&gt; [1] 0.2823139\n\n\n\n峰度（Kurtosis）\n\n表示随机变量概率分布的尖峭程度。四阶中心矩与方差平方的比值。\nhttps://www.macroption.com/kurtosis-formula/\n超值峰度 excess kurtosis ：四阶中心矩与方差平方的比值减3。\nhttps://www.macroption.com/excess-kurtosis/\n\\[\nKurt(X) =  \\frac{E(X_i-E(X))^4}{Var(X)^{2}}-3\\\\= E  [(\\frac{X_i-\\mu}{\\sigma})^4] - 3\\\\= \\frac{1}{n} \\sum_{i=1}^{n}  (\\frac{X_i-\\mu}{\\sigma} )^4-3\n\\]\n峰度的取值范围：\\([1,+\\infty)\\)\n超值峰度的取值范围：\\([-2,+\\infty)\\)\n\n超值峰度＜0，数据分布与正态分布相比较为扁平；\n超值峰度=0，正态分布；\n超值峰度＞0，数据分布与正态分布相比较为高尖。\n\n\n\n\nCodes$kurtosis\n#&gt; [1] -1.961786\n\nkurtosis&lt;-function(x,na.rm=TRUE){\n    if(na.rm) x&lt;-x[!is.na(x)]\n    n=length(x)\n    μ=mean(x)\n    SD=sd(x)\n    kurtosis= mean(((x-μ)/SD)^4)-3\n    return(kurtosis=kurtosis)\n}\nkurtosis(x)\n#&gt; [1] -1.961786\n\n\n\n1.3.4 统计摘要\n\nCodesummary(mtcars$mpg)\n#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n#&gt;   10.40   15.43   19.20   20.09   22.80   33.90\npsych::describeBy(mtcars$mpg,group = mtcars$am)\n#&gt; \n#&gt;  Descriptive statistics by group \n#&gt; group: 0\n#&gt;    vars  n  mean   sd median trimmed  mad  min  max range skew kurtosis   se\n#&gt; X1    1 19 17.15 3.83   17.3   17.12 3.11 10.4 24.4    14 0.01     -0.8 0.88\n#&gt; ------------------------------------------------------------ \n#&gt; group: 1\n#&gt;    vars  n  mean   sd median trimmed  mad min  max range skew kurtosis   se\n#&gt; X1    1 13 24.39 6.17   22.8   24.38 6.67  15 33.9  18.9 0.05    -1.46 1.71",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#统计表格",
    "href": "descriptive_statistics.html#统计表格",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.4 统计表格",
    "text": "1.4 统计表格\n\nCodeoptions(digits = 2)\nhead(mtcars)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nmpg\ncyl\ndisp\nhp\ndrat\nwt\nqsec\nvs\nam\ngear\ncarb\n\n\n\nMazda RX4\n21\n6\n160\n110\n3.9\n2.6\n16\n0\n1\n4\n4\n\n\nMazda RX4 Wag\n21\n6\n160\n110\n3.9\n2.9\n17\n0\n1\n4\n4\n\n\nDatsun 710\n23\n4\n108\n93\n3.8\n2.3\n19\n1\n1\n4\n1\n\n\nHornet 4 Drive\n21\n6\n258\n110\n3.1\n3.2\n19\n1\n0\n3\n1\n\n\nHornet Sportabout\n19\n8\n360\n175\n3.1\n3.4\n17\n0\n0\n3\n2\n\n\nValiant\n18\n6\n225\n105\n2.8\n3.5\n20\n1\n0\n3\n1\n\n\n\n\n\nCode\ntbl1 &lt;- tableone::CreateTableOne(vars = colnames(mtcars),\n                                 data = mtcars,\n                                 factorVars = c(\"cyl\"), # 分类\n                                 strata = c(\"am\"),  #分层\n                                 )\ntbl1\n#&gt;                   Stratified by am\n#&gt;                    0               1              p      test\n#&gt;   n                    19              13                    \n#&gt;   mpg (mean (SD))   17.15 (3.83)    24.39 (6.17)  &lt;0.001     \n#&gt;   cyl (%)                                          0.013     \n#&gt;      4                  3 (15.8)        8 (61.5)             \n#&gt;      6                  4 (21.1)        3 (23.1)             \n#&gt;      8                 12 (63.2)        2 (15.4)             \n#&gt;   disp (mean (SD)) 290.38 (110.17) 143.53 (87.20) &lt;0.001     \n#&gt;   hp (mean (SD))   160.26 (53.91)  126.85 (84.06)  0.180     \n#&gt;   drat (mean (SD))   3.29 (0.39)     4.05 (0.36)  &lt;0.001     \n#&gt;   wt (mean (SD))     3.77 (0.78)     2.41 (0.62)  &lt;0.001     \n#&gt;   qsec (mean (SD))  18.18 (1.75)    17.36 (1.79)   0.206     \n#&gt;   vs (mean (SD))     0.37 (0.50)     0.54 (0.52)   0.357     \n#&gt;   am (mean (SD))     0.00 (0.00)     1.00 (0.00)  &lt;0.001     \n#&gt;   gear (mean (SD))   3.21 (0.42)     4.38 (0.51)  &lt;0.001     \n#&gt;   carb (mean (SD))   2.74 (1.15)     2.92 (2.18)   0.754\n\n\n复现 图 1.1\n\n\n\n\n\n图 1.1\n\n\n\nCodedata &lt;- readRDS(\"data/brfss_tg_2014_raw.rds\")\ndata &lt;- data |&gt; \n    tidyr::drop_na() |&gt;\n    dplyr::filter(TRNSGNDR &lt;= 3) |&gt; \n    dplyr::filter(`_AGEG5YR` &gt;= 5 & `_AGEG5YR` &lt;= 11) |&gt; \n    dplyr::select(- c(HADMAM, `_AGE80`))\n\ndata_recoded &lt;- data |&gt; \n    dplyr::mutate(TRNSGNDR = forcats::as_factor(TRNSGNDR)) |&gt; \n    dplyr::mutate(TRNSGNDR = \n          forcats::fct_recode(TRNSGNDR, \"Male to female\" = \"1\")) |&gt; \n    dplyr::mutate(TRNSGNDR = \n          forcats::fct_recode(TRNSGNDR, \"Female to male\" = \"2\")) |&gt; \n    dplyr::mutate(TRNSGNDR = \n            forcats::fct_recode(TRNSGNDR, \"Gender non-conforming\" = \"3\")) |&gt; \n    \n    dplyr::mutate(`_AGEG5YR` = forcats::as_factor(`_AGEG5YR`)) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"40-44\" = \"5\")) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"45-49\" = \"6\")) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"50-54\" = \"7\")) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"55-59\" = \"8\")) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"60-64\" = \"9\")) |&gt; \n    dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"65-69\" = \"10\")) |&gt; \n        dplyr::mutate(`_AGEG5YR` = \n          forcats::fct_recode(`_AGEG5YR`, \"70-74\" = \"11\")) |&gt; \n    \n    dplyr::mutate(`_RACE` = forcats::as_factor(`_RACE`)) |&gt; \n    dplyr::mutate(`_RACE` = \n          forcats::fct_recode(`_RACE`, \"White\" = \"1\")) |&gt; \n    dplyr::mutate(`_RACE` = \n          forcats::fct_recode(`_RACE`, \"Black\" = \"2\")) |&gt; \n    dplyr::mutate(`_RACE` = \n          forcats::fct_recode(`_RACE`, \"Native American\" = \"3\")) |&gt; \n    dplyr::mutate(`_RACE` = \n          forcats::fct_recode(`_RACE`, \"Asian/Pacific Islander\" = \"4\")) |&gt; \n    dplyr::mutate(`_RACE` = \n          forcats::fct_collapse(`_RACE`, \"Other\" = \n                c(\"5\", \"7\", \"8\", \"9\"))) |&gt; \n    \n    dplyr::mutate(`_INCOMG` = forcats::as_factor(`_INCOMG`)) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"Less than $15,000\" = \"1\")) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"$15,000 to less than $25,000\" = \"2\")) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"$25,000 to less than $35,000\" = \"3\")) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"$35,000 to less than $50,000\" = \"4\")) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"$50,000 or more\" = \"5\")) |&gt; \n    dplyr::mutate(`_INCOMG` = \n          forcats::fct_recode(`_INCOMG`, \"Don't know/not sure/missing\" = \"9\")) |&gt;  \n\n    dplyr::mutate(`_EDUCAG` = forcats::as_factor(`_EDUCAG`)) |&gt; \n    dplyr::mutate(`_EDUCAG` = \n          forcats::fct_recode(`_EDUCAG`, \"Did not graduate highschool\" = \"1\")) |&gt; \n    dplyr::mutate(`_EDUCAG` = \n          forcats::fct_recode(`_EDUCAG`, \"Graduated highschool\" = \"2\")) |&gt; \n    dplyr::mutate(`_EDUCAG` = \n          forcats::fct_recode(`_EDUCAG`, \"Attended college/technical school\" = \"3\")) |&gt; \n    dplyr::mutate(`_EDUCAG` = \n          forcats::fct_recode(`_EDUCAG`, \"Graduated from college/technical school\" = \"4\")) |&gt; \n    \n    dplyr::mutate(HLTHPLN1 = forcats::as_factor(HLTHPLN1)) |&gt; \n    dplyr::mutate(HLTHPLN1 = \n          forcats::fct_recode(HLTHPLN1, \"Yes\" = \"1\")) |&gt; \n    dplyr::mutate(HLTHPLN1 = \n          forcats::fct_recode(HLTHPLN1, \"No\" = \"2\")) |&gt; \n    \n    dplyr::mutate(PHYSHLTH = dplyr::case_match(PHYSHLTH, \n                 77 ~ NA,\n                 99 ~ NA,\n                 88 ~ 0,\n                 .default = PHYSHLTH)) |&gt; \n\n    labelled::set_variable_labels(\n        TRNSGNDR = \"Transition status\",\n        `_AGEG5YR` = \"Age category\",\n        `_RACE` = \"Race/ethnicity\",\n        `_INCOMG` = \"Income category\",\n        `_EDUCAG` = \"Education category\",\n        HLTHPLN1 = \"Health insurance?\",\n        PHYSHLTH = \"Days poor physical health per month\"\n    )\n\n\ntbl1_gtsummary &lt;- data_recoded |&gt; \n    gtsummary::tbl_summary(\n        statistic = list(\n            gtsummary::all_continuous() ~ \"{median}\",\n            gtsummary::all_categorical() ~ \"{n}\"\n            ), \n         label = PHYSHLTH ~ \"Days poor physical health per month (median, IQR)\"\n    )\n\ntbl2_gtsummary &lt;- data_recoded |&gt; \n    gtsummary::tbl_summary(\n        statistic = list(\n            gtsummary::all_continuous() ~ \"({p25}, {p75})\",\n            gtsummary::all_categorical() ~ \"{p}%\"\n            ),\n        digits = list(gtsummary::all_categorical() ~ 1),\n        label = PHYSHLTH ~ \"Days poor physical health per month (median, IQR)\"\n    )\n\ntbl_merge_gtsummary &lt;- gtsummary::tbl_merge(\n    list(tbl1_gtsummary, tbl2_gtsummary)\n) |&gt; \n    gtsummary::bold_labels() |&gt; \n    gtsummary::modify_header(\n        list(\n            label ~ \"**Survey participants demographics (N = {n})**\",\n            stat_0_1 ~ \"**Frequency**\", \n            stat_0_2 ~ \"**Percent**\"\n        )\n    ) |&gt; \n    gtsummary::modify_spanning_header(gtsummary::everything() ~ NA) |&gt; \n    gtsummary::modify_footnote(gtsummary::everything() ~ NA) \n\ntbl_merge_gtsummary\n\n\n\n\n\n\n\n\n\n\n\nSurvey participants demographics (N = 222)\nFrequency\nPercent\n\n\n\nTransition status\n\n\n\n\n    Male to female\n77\n34.7%\n\n\n    Female to male\n113\n50.9%\n\n\n    Gender non-conforming\n32\n14.4%\n\n\nAge category\n\n\n\n\n    40-44\n27\n12.2%\n\n\n    45-49\n27\n12.2%\n\n\n    50-54\n32\n14.4%\n\n\n    55-59\n44\n19.8%\n\n\n    60-64\n44\n19.8%\n\n\n    65-69\n24\n10.8%\n\n\n    70-74\n24\n10.8%\n\n\nRace/ethnicity\n\n\n\n\n    White\n152\n68.5%\n\n\n    Black\n31\n14.0%\n\n\n    Native American\n4\n1.8%\n\n\n    Asian/Pacific Islander\n6\n2.7%\n\n\n    Other\n29\n13.1%\n\n\nIncome category\n\n\n\n\n    Less than $15,000\n46\n20.7%\n\n\n    $15,000 to less than $25,000\n44\n19.8%\n\n\n    $25,000 to less than $35,000\n19\n8.6%\n\n\n    $35,000 to less than $50,000\n26\n11.7%\n\n\n    $50,000 or more\n65\n29.3%\n\n\n    Don't know/not sure/missing\n22\n9.9%\n\n\nEducation category\n\n\n\n\n    Did not graduate highschool\n24\n10.8%\n\n\n    Graduated highschool\n86\n38.7%\n\n\n    Attended college/technical school\n68\n30.6%\n\n\n    Graduated from college/technical school\n44\n19.8%\n\n\nHealth insurance?\n198\n89.2%\n\n\nDays poor physical health per month (median, IQR)\n1\n(0, 11)\n\n\n    Unknown\n10\n10\n\n\n\n\n\n\n\n\nCodetbl_merge_gtsummary_small &lt;- tbl_merge_gtsummary |&gt; \n    gtsummary::as_gt() |&gt; \n    gt::tab_options(table.font.size = \"14px\")\n\ntbl_merge_gtsummary_small\n\n\n\n\n\n\n\n\n\n\n\nSurvey participants demographics (N = 222)\nFrequency\nPercent\n\n\n\nTransition status\n\n\n\n\n    Male to female\n77\n34.7%\n\n\n    Female to male\n113\n50.9%\n\n\n    Gender non-conforming\n32\n14.4%\n\n\nAge category\n\n\n\n\n    40-44\n27\n12.2%\n\n\n    45-49\n27\n12.2%\n\n\n    50-54\n32\n14.4%\n\n\n    55-59\n44\n19.8%\n\n\n    60-64\n44\n19.8%\n\n\n    65-69\n24\n10.8%\n\n\n    70-74\n24\n10.8%\n\n\nRace/ethnicity\n\n\n\n\n    White\n152\n68.5%\n\n\n    Black\n31\n14.0%\n\n\n    Native American\n4\n1.8%\n\n\n    Asian/Pacific Islander\n6\n2.7%\n\n\n    Other\n29\n13.1%\n\n\nIncome category\n\n\n\n\n    Less than $15,000\n46\n20.7%\n\n\n    $15,000 to less than $25,000\n44\n19.8%\n\n\n    $25,000 to less than $35,000\n19\n8.6%\n\n\n    $35,000 to less than $50,000\n26\n11.7%\n\n\n    $50,000 or more\n65\n29.3%\n\n\n    Don't know/not sure/missing\n22\n9.9%\n\n\nEducation category\n\n\n\n\n    Did not graduate highschool\n24\n10.8%\n\n\n    Graduated highschool\n86\n38.7%\n\n\n    Attended college/technical school\n68\n30.6%\n\n\n    Graduated from college/technical school\n44\n19.8%\n\n\nHealth insurance?\n198\n89.2%\n\n\nDays poor physical health per month (median, IQR)\n1\n(0, 11)\n\n\n    Unknown\n10\n10\n\n\n\n\n\n\n\n\nCodegtsummary::theme_gtsummary_compact() \ntbl_merge_gtsummary\n\n\n\n\n\n\n\n\n\n\n\nSurvey participants demographics (N = 222)\nFrequency\nPercent\n\n\n\nTransition status\n\n\n\n\n    Male to female\n77\n34.7%\n\n\n    Female to male\n113\n50.9%\n\n\n    Gender non-conforming\n32\n14.4%\n\n\nAge category\n\n\n\n\n    40-44\n27\n12.2%\n\n\n    45-49\n27\n12.2%\n\n\n    50-54\n32\n14.4%\n\n\n    55-59\n44\n19.8%\n\n\n    60-64\n44\n19.8%\n\n\n    65-69\n24\n10.8%\n\n\n    70-74\n24\n10.8%\n\n\nRace/ethnicity\n\n\n\n\n    White\n152\n68.5%\n\n\n    Black\n31\n14.0%\n\n\n    Native American\n4\n1.8%\n\n\n    Asian/Pacific Islander\n6\n2.7%\n\n\n    Other\n29\n13.1%\n\n\nIncome category\n\n\n\n\n    Less than $15,000\n46\n20.7%\n\n\n    $15,000 to less than $25,000\n44\n19.8%\n\n\n    $25,000 to less than $35,000\n19\n8.6%\n\n\n    $35,000 to less than $50,000\n26\n11.7%\n\n\n    $50,000 or more\n65\n29.3%\n\n\n    Don't know/not sure/missing\n22\n9.9%\n\n\nEducation category\n\n\n\n\n    Did not graduate highschool\n24\n10.8%\n\n\n    Graduated highschool\n86\n38.7%\n\n\n    Attended college/technical school\n68\n30.6%\n\n\n    Graduated from college/technical school\n44\n19.8%\n\n\nHealth insurance?\n198\n89.2%\n\n\nDays poor physical health per month (median, IQR)\n1\n(0, 11)\n\n\n    Unknown\n10\n10",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "descriptive_statistics.html#数据可视化",
    "href": "descriptive_statistics.html#数据可视化",
    "title": "\n1  描述性统计学\n",
    "section": "\n1.5 数据可视化",
    "text": "1.5 数据可视化\nR Notes\n\nbase_graphics\nggplot2_graphics",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>描述性统计学</span>"
    ]
  },
  {
    "objectID": "independence_correlation.html",
    "href": "independence_correlation.html",
    "title": "\n2  独立性和相关性\n",
    "section": "",
    "text": "2.1 分类变量的列联表和独立性检验",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>独立性和相关性</span>"
    ]
  },
  {
    "objectID": "independence_correlation.html#分类变量的列联表和独立性检验",
    "href": "independence_correlation.html#分类变量的列联表和独立性检验",
    "title": "\n2  独立性和相关性\n",
    "section": "",
    "text": "2.1.1 列联表\n\nCodedata(gss_cat)  #因子数据集\nhead(gss_cat)\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nyear\nmarital\nage\nrace\nrincome\npartyid\nrelig\ndenom\ntvhours\n\n\n\n2000\nNever married\n26\nWhite\n$8000 to 9999\nInd,near rep\nProtestant\nSouthern baptist\n12\n\n\n2000\nDivorced\n48\nWhite\n$8000 to 9999\nNot str republican\nProtestant\nBaptist-dk which\nNA\n\n\n2000\nWidowed\n67\nWhite\nNot applicable\nIndependent\nProtestant\nNo denomination\n2\n\n\n2000\nNever married\n39\nWhite\nNot applicable\nInd,near rep\nOrthodox-christian\nNot applicable\n4\n\n\n2000\nDivorced\n25\nWhite\nNot applicable\nNot str democrat\nNone\nNot applicable\n1\n\n\n2000\nMarried\n25\nWhite\n$20000 - 24999\nStrong democrat\nProtestant\nSouthern baptist\nNA\n\n\n\n\n\nCodetable(gss_cat$marital,gss_cat$race)\n#&gt;                \n#&gt;                 Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\nxtabs(formula = ~marital+race,data = gss_cat,subset =NULL)\n#&gt;                race\n#&gt; marital         Other Black White Not applicable\n#&gt;   No answer         2     2    13              0\n#&gt;   Never married   633  1305  3478              0\n#&gt;   Separated       110   196   437              0\n#&gt;   Divorced        212   495  2676              0\n#&gt;   Widowed          70   262  1475              0\n#&gt;   Married         932   869  8316              0\n\n\n\nCodeeg &lt;- matrix(c(156,9421,1531,14797),nrow=2,byrow=TRUE)\ncolnames(eg) &lt;- c(\"Disease\",\"Control\")\nrownames(eg) &lt;- c(\"Exposed\",\"Unexposed\")\nprint(eg)\n#&gt;           Disease Control\n#&gt; Exposed       156    9421\n#&gt; Unexposed    1531   14797\nprop.table(eg)          #各单元格比例\n#&gt;               Disease   Control\n#&gt; Exposed   0.006022003 0.3636750\n#&gt; Unexposed 0.059100560 0.5712025\nprop.table(eg,margin = 1)        #行比例 \n#&gt;              Disease   Control\n#&gt; Exposed   0.01628903 0.9837110\n#&gt; Unexposed 0.09376531 0.9062347\n\n# 边际\nmargin.table(x=eg,margin = 2)      #列和\n#&gt; Disease Control \n#&gt;    1687   24218\naddmargins(eg)          #添加行和、列和\n#&gt;           Disease Control   Sum\n#&gt; Exposed       156    9421  9577\n#&gt; Unexposed    1531   14797 16328\n#&gt; Sum          1687   24218 25905\naddmargins(eg,1)        #添加列和\n#&gt;           Disease Control\n#&gt; Exposed       156    9421\n#&gt; Unexposed    1531   14797\n#&gt; Sum          1687   24218\naddmargins(eg,2)        #添加行和\n#&gt;           Disease Control   Sum\n#&gt; Exposed       156    9421  9577\n#&gt; Unexposed    1531   14797 16328\naddmargins(prop.table(eg,1))\n#&gt;              Disease   Control Sum\n#&gt; Exposed   0.01628903 0.9837110   1\n#&gt; Unexposed 0.09376531 0.9062347   1\n#&gt; Sum       0.11005434 1.8899457   2\n\nftable(eg)   # \"平铺式\"列联表\n#&gt;            Disease Control\n#&gt;                           \n#&gt; Exposed        156    9421\n#&gt; Unexposed     1531   14797\n\n\n\n2.1.2 相对危险度与优势比\n　　相对危险度 （Relative Risk，RR），是指暴露组人群的发病率与非暴露组人群的发病率之比。RR 用于反映暴露因素与结局事件的关联程度， 其 取值范围为 0 到无穷大。数值为 1 时，表明暴露因素与结局事件无关联；小于 1 时，表 明暴露因素导致结局事件的发生率降低；大于 1 时，表明暴露因素导致结局事件的发生率增加。相对风险适用于队列研究。\n　　优势比（Odds Ratio，OR），是指暴露组中病例与非病例人数的比值除以非暴露组中病例与非病例人数的比值。　　OR 的取值范围也为 0 到无穷大。如果 OR 值大于 1 ，说明该暴露因素更 容易导致结果事件发生，或者说该因素是一个危险因素；小于 1 ，则说明该暴露因素更不 容易导致结果事件发生，或者说该因素是一个保护因素。比值比适用于队列研究和病例对照研究。\nUsing R for Biomedical Statistics\n\nCode# RR\n156/(156+9421)*(1531+14797)/1531\n#&gt; [1] 0.1737212\nsource(\"function/calcRelativeRisk.R\")\ncalcRelativeRisk(eg,alpha=0.05)\n#&gt; [1] \"category = Exposed , relative risk =  0.173721236521721\"\n#&gt; [1] \"category = Exposed ,  95 % confidence interval = [ 0.147624440337197 , 0.204431379720742 ]\"\n\n# OR\n156/9421/(1531/14797)\n#&gt; [1] 0.1600391\nsource(\"function/calcOddsRatio.R\")\ncalcOddsRatio(eg,alpha = 0.05)\n#&gt; [1] \"category = Exposed , odds ratio =  0.160039091621751\"\n#&gt; [1] \"category = Exposed ,  95 % confidence interval = [ 0.135460641900536 , 0.189077140693912 ]\"\n\n\n\nCodemymatrix &lt;- matrix(c(30,24,76,241,82,509),nrow=3,byrow=TRUE)\ncolnames(mymatrix) &lt;- c(\"Disease\",\"Control\")\nrownames(mymatrix) &lt;- c(\"Exposure1\",\"Exposure2\",\"Unexposed\")\nprint(mymatrix)\n#&gt;           Disease Control\n#&gt; Exposure1      30      24\n#&gt; Exposure2      76     241\n#&gt; Unexposed      82     509\ncalcOddsRatio(mymatrix, referencerow=3)\n#&gt; [1] \"category = Exposure1 , odds ratio =  7.75914634146342\"\n#&gt; [1] \"category = Exposure1 ,  95 % confidence interval = [ 4.32163714854064 , 13.9309131884372 ]\"\n#&gt; [1] \"category = Exposure2 , odds ratio =  1.95749418075094\"\n#&gt; [1] \"category = Exposure2 ,  95 % confidence interval = [ 1.38263094540732 , 2.77137111707344 ]\"\ncalcRelativeRisk(mymatrix, referencerow=3)\n#&gt; [1] \"category = Exposure1 , relative risk =  4.00406504065041\"\n#&gt; [1] \"category = Exposure1 ,  95 % confidence interval = [ 2.93130744422409 , 5.46941498113737 ]\"\n#&gt; [1] \"category = Exposure2 , relative risk =  1.72793721628068\"\n#&gt; [1] \"category = Exposure2 ,  95 % confidence interval = [ 1.30507489771431 , 2.2878127750653 ]\"\n\n\n\n2.1.3 独立性检验\n独立性：判断两个或多个分类变量之间是否存在关联或取值互不影响，分析联合概率分布是否可以分解为各自概率分布的乘积。\n\n2.1.3.1 \\(\\chi^2\\) 独立性检验\n\nCodeM &lt;- as.table(rbind(c(86, 29), c(44, 30)))\ndimnames(M) &lt;- list(gender = c(\"F\", \"M\"),\n                    smoking = c(\"Yes\",\"No\"))\nM\n#&gt;       smoking\n#&gt; gender Yes No\n#&gt;      F  86 29\n#&gt;      M  44 30\n\nchisq &lt;- chisq.test(M)\nchisq\n#&gt; \n#&gt;  Pearson's Chi-squared test with Yates' continuity correction\n#&gt; \n#&gt; data:  M\n#&gt; X-squared = 4.2359, df = 1, p-value = 0.03958\nchisq$expected  # 期望频数\n#&gt;       smoking\n#&gt; gender      Yes       No\n#&gt;      F 79.10053 35.89947\n#&gt;      M 50.89947 23.10053\nchisq$parameter # degrees of freedom\n#&gt; df \n#&gt;  1\n\n#对于频数表中每个单元格的期望频数都比较大（大于 5）的大样本，correct设为 FALSE,不进行连续校正\nchisq2 &lt;- chisq.test(M,correct = FALSE) \nchisq2\n#&gt; \n#&gt;  Pearson's Chi-squared test\n#&gt; \n#&gt; data:  M\n#&gt; X-squared = 4.9237, df = 1, p-value = 0.02649\n\n\n\n2.1.3.2 Fisher精确检验\n　　如果观察总记录数 n 小于 40，或者频数表里的某个期望频数很小（小于 1） ，则需要使 用 Fisher 精确概率检验。\n\nCode# Fisher's exact test to test independence of rows and columns in contingency table\nfisher.test(M)\n#&gt; \n#&gt;  Fisher's Exact Test for Count Data\n#&gt; \n#&gt; data:  M\n#&gt; p-value = 0.03618\n#&gt; alternative hypothesis: true odds ratio is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;  1.028780 3.964904\n#&gt; sample estimates:\n#&gt; odds ratio \n#&gt;   2.014137\n\n\n\n2.1.3.3 Cochran-Mantel-Haenszel \\(\\chi^2\\) 检验\n　　两个变量的关联有可能受到第三个变量的影响，因此我们有必要检验两个分类变量在 调整（控制）第三个变量的情况下是否独立。 Cochran-Mantel-Haenszel χ 2 检验常用于探索 变量间的混杂因素。其零假设是：两个分类变量在第三个变量的每一层都是条件独立的。函数 mantelhaen.test( ) 可以用来进行该检验。\n\nCodeRabbits &lt;-\narray(c(0, 0, 6, 5,\n        3, 0, 3, 6,\n        6, 2, 0, 4,\n        5, 6, 1, 0,\n        2, 5, 0, 0),\n      dim = c(2, 2, 5),\n      dimnames = list(\n          Delay = c(\"None\", \"1.5h\"),\n          Response = c(\"Cured\", \"Died\"),\n          Penicillin.Level = c(\"1/8\", \"1/4\", \"1/2\", \"1\", \"4\")))\nRabbits\n#&gt; , , Penicillin.Level = 1/8\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     0    6\n#&gt;   1.5h     0    5\n#&gt; \n#&gt; , , Penicillin.Level = 1/4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     3    3\n#&gt;   1.5h     0    6\n#&gt; \n#&gt; , , Penicillin.Level = 1/2\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     6    0\n#&gt;   1.5h     2    4\n#&gt; \n#&gt; , , Penicillin.Level = 1\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     5    1\n#&gt;   1.5h     6    0\n#&gt; \n#&gt; , , Penicillin.Level = 4\n#&gt; \n#&gt;       Response\n#&gt; Delay  Cured Died\n#&gt;   None     2    0\n#&gt;   1.5h     5    0\n\nmantelhaen.test(Rabbits)\n#&gt; \n#&gt;  Mantel-Haenszel chi-squared test with continuity correction\n#&gt; \n#&gt; data:  Rabbits\n#&gt; Mantel-Haenszel X-squared = 3.9286, df = 1, p-value = 0.04747\n#&gt; alternative hypothesis: true common odds ratio is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;   1.026713 47.725133\n#&gt; sample estimates:\n#&gt; common odds ratio \n#&gt;                 7\n\n\n\n2.1.3.4 配对列联表的 χ 2 检验\n　　医学科研实践中经常遇到配对设计的计数资料，例如两种检验方法、诊断方法结果的 比较。其特点是对每个研究对象分别用两种方法处理，然后观察两种处理方法的某两分类 变量的计数结果。对于这种数据，我们也可以整理成列联表的形式，但是不能用前述的 χ 2独立性检验，需进行 Mcnemar 检验。\n\nCode#　　某实验室分别用免疫荧光法和乳胶凝集法对 58 名疑似系统性红斑狼疮患者血清中抗 核抗体进行测定\nresult&lt;- matrix(c(11, 2, 12, 33), nrow = 2,dimnames = list(c(\"+\",\"-\"),c(\"+\",\"-\")))\nresult\n#&gt;    +  -\n#&gt; + 11 12\n#&gt; -  2 33\n\n#　　对于配对四格表，如果样本量较小（不一致的结果的总数小于 40 ） ，则需要进行连续性校正。\nmcnemar.test(result,correct = TRUE)\n#&gt; \n#&gt;  McNemar's Chi-squared test with continuity correction\n#&gt; \n#&gt; data:  result\n#&gt; McNemar's chi-squared = 5.7857, df = 1, p-value = 0.01616",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>独立性和相关性</span>"
    ]
  },
  {
    "objectID": "independence_correlation.html#分类变量间的相关性",
    "href": "independence_correlation.html#分类变量间的相关性",
    "title": "\n2  独立性和相关性\n",
    "section": "\n2.2 分类变量间的相关性",
    "text": "2.2 分类变量间的相关性\n　　如果独立性检验的结果表明两个变量之间不独立，那么很自然地我们就想量化它们之间相关性的强弱。 vcd 包里的函数 assocstats( )可以用来计算列联表的 Phi 系数、列联系数和 Cramer’s V 系数。其中， Phi 系数只适用于四格表。 　　 　　\n\n2.2.1 相关系数 　　\n\nCodelibrary(vcd)\nmytable &lt;- table(Arthritis$Treatment, Arthritis$Improved)\nassocstats(mytable)\n#&gt;                     X^2 df  P(&gt; X^2)\n#&gt; Likelihood Ratio 13.530  2 0.0011536\n#&gt; Pearson          13.055  2 0.0014626\n#&gt; \n#&gt; Phi-Coefficient   : NA \n#&gt; Contingency Coeff.: 0.367 \n#&gt; Cramer's V        : 0.394\n\n\n　　对于配对列联表，可以计算一致性指标 Kappa 统计量。 epiDisplay 包里的函数 kap( )可以用于计算一致性的比例以及 Kappa 统计量的值 　　 　　\n\nCodemy.matrix &lt;- matrix(c(11, 2, 12, 33), nrow = 2)\nepiDisplay::kap(my.matrix)\n#&gt; \n#&gt;  Table for calculation of kappa\n#&gt;    A  B\n#&gt; A 11 12\n#&gt; B  2 33\n#&gt; \n#&gt; Observed agreement = 75.86 % \n#&gt; Expected agreement = 55.71 % \n#&gt; Kappa = 0.455 \n#&gt; Standard error = 0.121 , Z = 3.762 , P value = &lt; 0.001 \n#&gt; \n\n\n　　共 58 个对象，每一对象用两种检测方法检测，其中 1 个对象的两种检测结果都为阳 性， 33 个对象的两种检测结果都是阴性，所以总的一致性为 (1 + 33)/58 ≈ 75.86% 。为了解释期望一致性和 Kappa 值的含义，先计算各个单元格的期望频数。 　　 　　\n\nCodechisq.test(my.matrix)$expected\n#&gt;          [,1]     [,2]\n#&gt; [1,] 5.155172 17.84483\n#&gt; [2,] 7.844828 27.15517\n\n\n　　对角线上的这两个单元格对应的期望频数分别约为 5.15 和 27.15 ，因此期望一致性为 (5.155 + 27.15)/58 ≈ 55.71% 。期望一致性是假定两种方法的检测结果都是完全随机的情况下的 一致性。也就是说，即使两种检测方法都毫无作用，平均也能达到 5.71% 的一致性。 Kappa 统 计量是超出随机的一致性的部分占最大可能超出随机的一致性的比例。在本例中，前者为 75.86% − 55.71% ， 后者为 100% − 55.71% 。 因此， Kappa 值为 (75.86 − 5.71)/(10 − 5.71) ≈ 0.45\n\n2.2.2 马赛克图\n　　马赛克图中的矩形面积正比于多维列联表中单元格的频率 　　\n\nCodemosaic(~ Sex + Treatment + Improved, data = Arthritis)",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>独立性和相关性</span>"
    ]
  },
  {
    "objectID": "independence_correlation.html#连续变量的相关性检验",
    "href": "independence_correlation.html#连续变量的相关性检验",
    "title": "\n2  独立性和相关性\n",
    "section": "\n2.3 连续变量的相关性检验",
    "text": "2.3 连续变量的相关性检验\n相关性：判断两个变量之间的线性关系强度和方向，无论是否独立。\n协方差（或相关系数）为零，不相关，不存在线性关系，但可能存在非线性关系。\n\nCodedf &lt;- mpg[,c(3,8,9)]\ncov(df)    # 协方差矩阵\n#&gt;           displ      cty       hwy\n#&gt; displ  1.669158 -4.39069 -5.893111\n#&gt; cty   -4.390690 18.11307 24.225432\n#&gt; hwy   -5.893111 24.22543 35.457779\n\n\n\n2.3.0.1 相关系数\n相关系数的取值范围： \\([-1,1]\\)\n\nCode# Pearson's 积差相关系数 　　一般要求两个连续变量都服从正态分布\ncor(df,use = \"everything\",method=\"pearson\") # default\n#&gt;           displ        cty        hwy\n#&gt; displ  1.000000 -0.7985240 -0.7660200\n#&gt; cty   -0.798524  1.0000000  0.9559159\n#&gt; hwy   -0.766020  0.9559159  1.0000000\n\n# Spearman's rank相关系数  　　非参数\ncor(df,method = \"spearman\")\n#&gt;            displ        cty        hwy\n#&gt; displ  1.0000000 -0.8809049 -0.8266576\n#&gt; cty   -0.8809049  1.0000000  0.9542104\n#&gt; hwy   -0.8266576  0.9542104  1.0000000\n\n# Kendall's tau相关系数  　　非参数\ncor(df,method = \"kendall\")\n#&gt;            displ        cty        hwy\n#&gt; displ  1.0000000 -0.7210828 -0.6536974\n#&gt; cty   -0.7210828  1.0000000  0.8628045\n#&gt; hwy   -0.6536974  0.8628045  1.0000000\n\n\n\n2.3.0.2 相关图（correlogram）\n?sec-correlogram\n\nCodeggcorrplot::ggcorrplot(\n    corr = cor(df,use = \"everything\",method=\"pearson\") ,\n)\n\n\n\n\n\n\n\n\n2.3.0.3 相关系数的假设检验\n　　零假设为变量之间不相关（即两个总体的相关系数为 0 ） 。函数 cor.test( ) 可用于对相关系数进行显著性检 验。\n\nCodecor.test(df$displ,df$hwy)\n#&gt; \n#&gt;  Pearson's product-moment correlation\n#&gt; \n#&gt; data:  df$displ and df$hwy\n#&gt; t = -18.151, df = 232, p-value &lt; 2.2e-16\n#&gt; alternative hypothesis: true correlation is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  -0.8142727 -0.7072539\n#&gt; sample estimates:\n#&gt;      cor \n#&gt; -0.76602\n\n\npsych包corr.test() 计算相关系数矩阵和显著性检验\n\nCodepsych::corr.test(df)\n#&gt; Call:psych::corr.test(x = df)\n#&gt; Correlation matrix \n#&gt;       displ   cty   hwy\n#&gt; displ  1.00 -0.80 -0.77\n#&gt; cty   -0.80  1.00  0.96\n#&gt; hwy   -0.77  0.96  1.00\n#&gt; Sample Size \n#&gt; [1] 234\n#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) \n#&gt;       displ cty hwy\n#&gt; displ     0   0   0\n#&gt; cty       0   0   0\n#&gt; hwy       0   0   0\n#&gt; \n#&gt;  To see confidence intervals of the correlations, print with the short=FALSE option\n\nprint(psych::corr.test(df), short = FALSE)\n#&gt; Call:psych::corr.test(x = df)\n#&gt; Correlation matrix \n#&gt;       displ   cty   hwy\n#&gt; displ  1.00 -0.80 -0.77\n#&gt; cty   -0.80  1.00  0.96\n#&gt; hwy   -0.77  0.96  1.00\n#&gt; Sample Size \n#&gt; [1] 234\n#&gt; Probability values (Entries above the diagonal are adjusted for multiple tests.) \n#&gt;       displ cty hwy\n#&gt; displ     0   0   0\n#&gt; cty       0   0   0\n#&gt; hwy       0   0   0\n#&gt; \n#&gt;  Confidence intervals based upon normal theory.  To get bootstrapped values, try cor.ci\n#&gt;           raw.lower raw.r raw.upper raw.p lower.adj upper.adj\n#&gt; displ-cty     -0.84 -0.80     -0.75     0     -0.85     -0.74\n#&gt; displ-hwy     -0.81 -0.77     -0.71     0     -0.81     -0.71\n#&gt; cty-hwy        0.94  0.96      0.97     0      0.94      0.97",
    "crumbs": [
      "统计描述",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>独立性和相关性</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html",
    "href": "probability_fundamentals.html",
    "title": "\n3  概率论基础\n",
    "section": "",
    "text": "3.1 概念\n样本点（sample point）是每一次随机试验的结果，用 \\(\\omega\\) 表示。\n样本空间（sample space）是所有样本点的集合，用\\(\\Omega=\\{\\omega_{i};i=0,1,2,... \\}\\)表示。\n随机事件（random event）是一组样本点（\\(\\Omega\\)的子集）的集合，用大写字母 \\(A,B,C,...\\)表示。\n一个样本点的集合称为简单事件（simple event），用 \\(\\Omega=\\{\\omega\\}\\) 表示。\n若干个简单事件的集合称为混合事件（composite event）。全集 \\(\\Omega\\) 称为必然事件（deterministic event），空集（null set） \\(\\emptyset\\) 称为不可能事件（impossible event）。\n加法\n\\[\nP(A\\cup B)=P(A)+P(B)-P(A\\cap B)\n\\]\n条件概率\n\\[\nP(B|A)=\\frac{P(A\\cap B)}{P(A)}\n\\]\n乘法\n\\[\nP(A\\cap B)=P(A)\\times P(B|A)\n\\]\n独立事件（交集的概率等于各自概率的乘积）\n\\[ P(B|A)=P(B) \\ 或者\\  P(A)=0 \\]\n全概率公式（给定Ai发生，B的加权平均条件概率）\n\\[P(B)=\\sum_{i=1}^{n}P(A_i)P(B|A_i)\\]\n贝叶斯法则/逆概率公式（后验概率）\n\\[P(A_k |B)=\\frac{P(A_k)P(B|A_k)}{\\sum_{i=1}^{n}P(A_i)P(B|A_i)}\\]",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#概念",
    "href": "probability_fundamentals.html#概念",
    "title": "\n3  概率论基础\n",
    "section": "",
    "text": "包含关系（containment） ：Venn diagram\n\n\\(A\\subseteq B\\)\n\\(A\\supseteq B\\)\n\n\n并集（\\(A\\cup B\\)）\n交集（\\(A\\cap B\\)）\n补集（\\(\\bar A\\)）\n互斥事件 \\(A\\cap B=\\emptyset\\)\n互补事件 \\(A\\cap B=\\emptyset\\) 且 \\(A\\cup B=\\Omega\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#离散型随机变量",
    "href": "probability_fundamentals.html#离散型随机变量",
    "title": "\n3  概率论基础\n",
    "section": "\n3.2 离散型随机变量",
    "text": "3.2 离散型随机变量\n概率分布列： \\(P(X=x_k)=p_k (k=1,2,…)\\)\n累计分布函数：\\(F(x) =P(X≤x)= \\sum_{x_k≤x}p_k\\)\n期望：\\(E(X)=\\sum_{k}x_k p_k(k=1,2,...)\\)\n方差：\\(Var(X)=\\sum_{k}x_k^2 p_k-\\mu^2\\)\n\n3.2.1 二项分布\n组合（combination）：\\(C_n^k =\\frac {n!}{k!(n-k)!}\\)\n概率质量函数（pmf）：\\(P(X=k)=p_k=C_n^k\\pi^k(1-\\pi)^{n-k} \\ (k=0,1,...,n)\\)\n\\[\nX\\sim B(n,\\pi)\n\\]\n其中n表示独立试验的次数，\\(\\pi\\) 表示成功概率。\n累计概率：至多k0次成功的概率——\\(P(X≤k_0)=\\sum_{k=0}^{k_0} p_k\\)\n至少k0次成功的概率——\\(P(X≥k_0)=\\sum_{k=k_0}^{n} p_k\\)\n期望：\\(E(X)=n\\pi\\)\n方差：\\(Var(X)=n\\pi(1-\\pi)\\)\n\n3.2.2 多项式分布\n概率：\\(P(X_1=n_1,...,X_i=n_i,...,X_k=n_k)=\\frac {n!}{n_1!...n_i!...n_k!}\\pi_1^{n_1}...\\pi_i^{n_i}...\\pi_k^{n_k}\\)\n\\[\nX \\sim M(n,\\pi_1,\\pi_2,...,\\pi_k)\n\\]\n其中\\(n=n_1+n_2+...+n_k\\) 表示独立试验的次数，\\(\\pi_k\\) 表示\\(k\\) 个互斥结果的成功概率。\n期望(\\(A_i 与 -A_i\\))：\\(\\mu_{A_i}=n\\pi_{A_i}\\)\n方差(\\(A_i 与 -A_i\\))：\\(\\sigma_{A_i}^2=n\\pi_{A_i}(1-\\pi_{A_i})\\)\n\n3.2.3 泊松分布\n概率： \\(P(X=k)=p_k=\\frac {\\lambda ^k}{k!}e^{-\\lambda} (\\lambda &gt; 0;k=0,1,…)\\)\n\\[\nX\\sim P(\\lambda)\n\\]\n其中\\(\\lambda\\) 表示单位时间/空间罕见事件发生的期望值。\n期望：\\(\\mu=\\lambda\\)\n方差：\\(\\sigma^2=\\lambda\\)\n\n3.2.3.1 二项分布近似泊松分布\n当\\(n(n≥100)\\)足够大，\\(\\pi(\\pi ≤0.01)\\) 足够小，二项分布的均值 \\(n\\pi\\) 与方差\\(n\\pi(1-\\pi)\\approx n\\pi\\) 近似相等，此时的二项分布近似\\(\\lambda=n\\pi\\) 的泊松分布。\n\\[\nP(X=k)=C_n^k \\pi^k(1-\\pi)^{n-k} \\approx \\frac{\\lambda ^k}{k!}e^{-\\lambda}\n\\]",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "probability_fundamentals.html#连续型随机变量",
    "href": "probability_fundamentals.html#连续型随机变量",
    "title": "\n3  概率论基础\n",
    "section": "\n3.3 连续型随机变量",
    "text": "3.3 连续型随机变量\n概率：\\(P(a≤X≤b)=\\int_{a}^{b}f(x)dx\\)\n概率密度函数（pdf）：\\(f(x)\\)\n累计分布函数（cdf）：\\(F(x)=P(X≤x)=\\int_{-\\infty}^{x}f(t)dt\\)\n期望：\\(E(X)\\equiv\\mu =\\int_{-\\infty}^{+\\infty}xf(x)dx\\)\n方差：\\(\\sigma^2\\equiv E(X^2)-\\mu^2=\\int_{-\\infty}^{+\\infty}x^2f(x)dx-[\\int_{-\\infty}^{+\\infty}xf(x)dx]^2\\)\n\n3.3.1 正态分布\n概率密度函数（pdf）：\\(f(x)=\\frac {1}{\\sigma\\sqrt{2\\pi}}e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}}（-\\infty ＜x ＜+\\infty）\\)\n累计分布函数（cdf）:\\(F(x)=P(X≤x)=\\int_{-\\infty}^{x}f(t)dt=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\int_{-\\infty}^{x}e^{-\\frac{(t-\\mu)^2}{2\\sigma^2}}dt\\ (-\\infty＜x＜+\\infty)\\)\n\\[\nX \\sim N(\\mu,\\sigma^2)\n\\]\n\n3.3.2 标准正态分布\n\\[\nZ=\\frac {X-\\mu}{\\sigma} \\sim \\ N(0,1)\n\\]\npdf：\\(\\varphi (z)=\\frac{1}{\\sqrt{2\\pi}}e^{-\\frac{z^2}{2}} (-\\infty＜z＜+\\infty)\\)\ncdf：\\(\\Phi(z)=P(Z≤z)=\\int_{-\\infty}^{z}\\varphi (\\nu )d\\nu =\\frac{1}{\\sqrt{2\\pi}}\\int_{-\\infty}^{z}e^{-\\frac{\\nu^2}{2}}dt\\ (-\\infty＜z＜+\\infty)\\)\n\nCode# 标准正态分布\nnorm &lt;- function(xlim = c(-Inf,+Inf)){\n  ggplot() + xlim(xlim) +\n    geom_function(fun = dnorm, args = list(mean = 0, sd = 1), color=\"red\")+\n        scale_y_continuous(limits = c(0,1))+\n    geom_function(fun = pnorm,color=\"blue\")\n}\nnorm(c(-10,10))         # Area Under the Curve (AUC) = 1\n\n\n\n\n\n\n\n\n3.3.3 正态性的检验\n\n3.3.3.1 直方图/茎叶图\n直方图：钟形分布（bell-shaped distribution）\n\nCode\nh&lt;-hist(mtcars$mpg,breaks = 12)\nx&lt;-seq(min(mtcars$mpg),max(mtcars$mpg),by=0.001)\ny&lt;-dnorm(x,mean=mean(mtcars$mpg),sd=sd(mtcars$mpg)) #密度曲线  f(x)=(F(i)/n)/ΔXi\ny&lt;-y*diff(h$mids[1:2])*length(mtcars$mpg)  # f(x)*ΔXi*n  正态分布\nlines(x,y,col=\"blue\")\n\n\n\n\n\n\n\n茎叶图（Stem-and-Leaf Plot）\n\n3.3.3.2 P-P图/Q-Q图\nP-P图是累计相对频率的观测值（x轴）与理论值（y轴）的散点图；\nQ-Q图是分位数的观测值（x轴）与理论值（y轴）的散点图。\n\nCodelibrary(ggpubr)\nggqqplot(mtcars$mpg)  #  直线 \n\n\n\n\n\n\n\n\n3.3.3.3 矩量法（Moment Method）\n偏度=0 且 超值峰度=0\n\n3.3.4 二项分布近似正态分布\n当\\(n\\pi(1-\\pi)≥5 且X\\sim B(n,\\pi)\\)时，\\(P(a≤X≤b)近似等于X\\sim N(n\\pi,n\\pi(1-\\pi))在区间(a-0.5,b+0.5)上的曲线下面积\\)。\n\\[\nZ=\\frac{x-\\mu}{\\sigma}=\\frac{x-n\\pi}{\\sqrt{n\\pi(1-\\pi)}}\n\\]\n\n3.3.5 泊松分布近似正态分布\n当\\(\\lambda≥10 且X\\sim P(\\lambda)\\)时，\\(P(a≤X≤b)近似等于X\\sim N(\\lambda,\\lambda)在区间(a-0.5,b+0.5)上的曲线下面积\\)。\n\\[\nZ=\\frac{x-\\mu}{\\sigma}=\\frac{x-\\lambda}{\\sqrt{\\lambda}}\n\\]\n\n3.3.6 医学参考区间\n\n3.3.7",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>概率论基础</span>"
    ]
  },
  {
    "objectID": "SamplingDistribution.html",
    "href": "SamplingDistribution.html",
    "title": "4  抽样分布",
    "section": "",
    "text": "统计量（statistic）\n\n假设\\(\\hat\\theta=\\hat\\theta(X_1,X_2,...,X_n)\\) 是关于随机样本\\(X_1,X_2,...,X_n\\) 的函数，且不依赖任何未知的总体参数\\(\\theta\\) ，则\\(\\hat\\theta\\) 称为统计量（statistic）。\n\n\n样本均值 \\(\\hat \\theta_1=\\bar X=\\frac{\\sum_{i=1}^{n}{X_i}}{n}\\) 和样本方差 \\(\\hat \\theta_2=S^2=\\frac{\\sum_{i=1}^{n} (X_i-\\bar X)^2}{n-1}\\) 是统计量（statistics）。\n\n4.0.1 均值（mean）的抽样分布\n假设 \\(X_1,X_2,...,X_n\\)是来自均值为\\(μ\\)，有限方差为\\(σ^2\\)的总体为 \\(X\\)的一组样本量为n的随机样本。\\(\\bar X\\) 的抽样分布是指从总体 \\(X\\)中选择的样本量为\\(n\\)的所有可能样本的 \\(\\bar x\\)值（\\(\\bar x=\\sum_{i}x_i/n\\)）的分布。\n\n4.0.1.1 σ2 已知的正态分布\n\\[\n\\bar X \\sim N(μ,\\frac{σ^2}{n})\n\\]\n标准化\\(\\bar X\\)\n\\[\nZ=\\frac{\\bar X-\\mu}{\\sigma_{\\bar X}}=\\frac{\\bar X-\\mu}{\\sigma /\\sqrt n} \\sim N(0,1)\n\\]\n均值的标准误 \\(\\sigma _{\\bar X} =\\frac {\\sigma}{\\sqrt n}\\) 可以用 \\(S _{\\bar X} =\\frac {S}{\\sqrt n}\\) 估计。\n\n\n4.0.1.2 大样本量的非正态分布\n\n中心极限定理（central limit theorem）\n\n当样本量n足够大时，即使随机样本并非来自正态分布总体，\\(\\bar X\\) 的抽样分布也会近似正态分布。\n\\[ \\bar X \\dot{\\sim}  N(μ,\\frac{σ^2}{n}) \\]\n\n\n\n\n4.0.1.3 σ2 未知的正态分布\n\\[ t=\\frac{\\bar X-\\mu}{S_{\\bar X}}=\\frac{\\bar X-\\mu}{S /\\sqrt n} \\sim t(\\nu) \\]\n其中自由度（degrees of freedom）\\(\\nu=n-1\\) 。当 \\(\\nu \\to +\\infty 时,t\\sim N(0,1)\\) 。\n\n\n\n4.0.2 方差（variance）的抽样分布\n假设 \\(X_1,X_2,...,X_n\\)是来自均值为\\(μ\\)，有限方差为\\(σ^2\\)的总体为 \\(X\\)的一组样本量为n的随机样本。列出样本量为\\(n\\)的所有可能随机样本。\n\n4.0.2.1 \\(\\chi^2\\)分布\n\\[\n\\frac {(n-1)S^2}{\\sigma^2}\\sim \\chi^2(\\nu)\n\\]\n其中自由度（degrees of freedom）\\(\\nu=n-1\\) 。\n\n\n\n4.0.3 率（rate）抽样分布——分类数据\n假设 \\(X\\sim B(n,\\pi)\\) ，一组样本量为n的随机样本。列出样本量为\\(n\\)的所有可能随机样本。\n样本率\\(p=X/n\\) ，则 \\[\nE(p)=E(X/n)=\\frac{1}{n}E(X)=\\pi\n\\] \\[\nVar(p)=Var(X/n)=\\frac{1}{n^2}Var(X)=\\frac{\\pi(1-\\pi)}{n}\n\\]\n率的标准误 \\(\\sigma_p =\\sqrt{\\frac{\\pi(1-\\pi)}{n}}\\) 可以用 \\(S _p =\\sqrt{\\frac{p(1-p)}{n}}\\) 估计。\n当\\(n\\pi(1-\\pi)≥5 且X\\sim B(n,\\pi)\\)时，率的抽样分布 \\[\np\\dot\\sim N(\\pi,\\frac{\\pi(1-\\pi)}{n})\n\\]",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>抽样分布</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html",
    "href": "ParameterEstimation.html",
    "title": "5  参数估计",
    "section": "",
    "text": "5.1 一个总体的参数估计",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html#一个总体的参数估计",
    "href": "ParameterEstimation.html#一个总体的参数估计",
    "title": "5  参数估计",
    "section": "",
    "text": "5.1.0.1 点估计\n假设 \\(\\theta\\)是总体\\(X\\)的一个参数，\\(\\hat\\theta=\\hat\\theta(X_1,X_2,...,X_n)\\)是代表\\(\\theta\\)的数值估计的一个统计量。任何可能的\\(\\hat\\theta\\)称为\\(\\theta\\)的点估计。\n\n无偏性（unbiasedness）\n如果\\(E(\\hat\\theta)=\\theta\\),就说参数\\(\\theta\\)的一个估计\\(\\hat\\theta\\)是无偏的。\n\\[\n\\bar X=\\sum_{i=1}^{n}X_i/n\n\\]\n\\[\nE(\\bar X)=\\frac{1}{n}E(\\sum_{i=1}^{n}X_i)=\\frac{n\\mu}{\\mu}=\\mu\n\\]\n所以样本均值\\(\\bar X\\)是总体均值\\(\\mu\\)的一个无偏估计。\n\\[\nS^2=\\frac{1}{n-1}\\sum_{i=1}^{n}(X_i-\\bar X)^2\n\\]\n\\[\nE(S^2)=E(\\frac{n}{n-1}S_n^2)=\\frac{n}{n-1}E(S_n^2)=\\frac{n}{n-1}E(\\frac {1}{n}\\sum_{i=1}^{n}(X_i-\\bar X)^2\\\\=\\frac{n}{n-1}\\times\\frac{n-1}{n}\\sigma^2=\\sigma^2\n\\] 所以样本方差\\(S^2\\)是总体方差\\(\\sigma^2\\)的一个无偏估计。\n\n\n最小方差无偏估计（MVUE）\n\\(\\hat\\theta\\)无偏且最小方差\n\n\n一致性（consistency）\n对于任意一个\\(\\epsilon＞0\\) ，如果 \\[\\lim_{n\\to \\infty}P(|\\hat\\theta_n-\\theta|＜\\epsilon)=1\\] 那么\\(\\hat\\theta_n\\)是总体参数\\(\\theta\\)的一个一致估计。\n\n\n\n5.1.1 区间估计\n\n5.1.1.1 均值的区间估计\n\n\\(\\sigma^2\\)已知的正态分布\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(\\bar X\\sim N(\\mu,\\frac{\\sigma^2}{n})\\),变换\\(Z=\\frac{\\bar X-\\mu}{\\sigma/\\sqrt n}\\sim N(0,1)\\)。\n对于给定的\\(\\alpha\\)，称\\(z_{\\alpha/2}\\)和\\(z_{1-\\alpha/2}\\)为临界值（critical value）。当\\(Z\\)分布是对称的，\\(z_{\\alpha/2}=-z_{1-\\alpha/2}\\)。\n区间估计的置信水平（confidence level）：\\(1-\\alpha\\)\n总体均值的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\frac{\\sigma}{\\sqrt n}\\)\n\n\n大样本量的非正态分布\n\\(X_1,X_2,...,X_n\\)是来自非正态分布的随机样本,当样本量足够大时，\\(\\bar X \\dot{\\sim} N(μ,\\frac{σ^2}{n})\\), 变换\\(Z=\\frac{\\bar X-\\mu}{S/\\sqrt n}\\dot\\sim N(0,1)\\)。\n总体均值的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\frac{S}{\\sqrt n}\\)\n\n\n\\(\\sigma^2\\)未知的正态分布\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(t=\\frac{\\bar X-\\mu}{S /\\sqrt n} \\sim t(\\nu),\\nu=n-1\\)。\n对于给定的\\(\\alpha\\)，称\\(t_{\\nu,\\alpha/2}\\)和\\(t_{\\nu,1-\\alpha/2}\\)为临界值（critical value）。\\(t_{\\alpha/2}=-t_{1-\\alpha/2}\\)。\n总体均值的置信区间（confidence interval）：\\([\\bar X- t_{\\nu,1-\\alpha/2}\\frac{S}{\\sqrt n},\\bar X+ t_{\\nu,1-\\alpha/2}\\frac{S}{\\sqrt n}]\\)\n\n\n\n5.1.1.2 方差的区间估计\n\\(X_1,X_2,...,X_n\\)是来自\\(N(\\mu,\\sigma^2)\\)的随机样本,则\\(\\frac {(n-1)S^2}{\\sigma^2}\\sim \\chi^2(\\nu),\\nu=n-1\\)\n对于给定的\\(\\alpha\\)，称\\(\\chi^2_{\\nu,\\alpha/2}\\)和\\(\\chi^2_{\\nu,1-\\alpha/2}\\)为临界值（critical value）。\n区间估计的置信水平（confidence level）：\\(1-\\alpha\\)\n总体方差的置信区间（confidence interval）：\\([\\frac {(n-1)S^2}{\\chi^2_{\\nu,1-\\alpha/2}},\\frac {(n-1)S^2}{\\chi^2_{\\nu,\\alpha/2}}]\\)\n\n\n5.1.1.3 率的区间估计\n\\(X_1,X_2,...,X_n\\)是来自\\(B(n,\\pi)\\)的随机样本, 当\\(n\\pi(1-\\pi)≥5\\)时，率的抽样分布 \\(p\\dot\\sim N(\\pi,\\frac{\\pi(1-\\pi)}{n})\\)，则变换\\(Z=\\frac{p-\\pi}{\\sqrt{p(1-p)/n}}\\dot\\sim N(0,1)\\)。\n总体率的置信区间（confidence interval）：\\(\\bar X \\pm z_{1-\\alpha/2}\\sqrt{\\frac{p(1-p)}{n}}\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "ParameterEstimation.html#两个总体的参数估计",
    "href": "ParameterEstimation.html#两个总体的参数估计",
    "title": "5  参数估计",
    "section": "5.2 两个总体的参数估计",
    "text": "5.2 两个总体的参数估计\n\n5.2.1 均值差异的估计\n\n5.2.1.1 点估计\n\\[E(\\bar X_1-\\bar X_2)=\\mu_1-\\mu_2\\]\n\\[Var(\\bar X_1-\\bar X_2)=\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}\\]\n统计量\\(\\bar X_1-\\bar X_2\\)是\\(\\mu_1-\\mu_2\\)的MVUE。\n\n\n5.2.1.2 区间估计\n\n正态分布或中心极限定理成立\n当\\(n_1＞30\\ \\&\\ n_2＞30\\)时，\n\\[\n(\\bar X_1-\\bar X_2) \\dot\\sim N(\\mu_1-\\mu_2,\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2})\n\\] 标准化变换 \\[\nZ=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}}}\\dot\\sim N(0,1)\n\\] 用样本方差代替总体方差，总体均值的置信区间（confidence interval）：\\(\\bar X_1-\\bar X_2 \\pm z_{1-\\alpha/2}\\sqrt{\\frac{S^2_1}{n_1}+\\frac{S^2_2}{n_2}}\\)\n\n\n方差相等的未知正态分布\n\\[\nt=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{S_{\\bar X_1-\\bar X_2}}\\sim t(\\nu)\n\\]\n其中\\(v=n_1+n_2-2\\) 和 \\[\nS_{\\bar X_1-\\bar X_2}=\\sqrt{S_C^2(\\frac{1}{n_1}+\\frac{1}{n_2})}\n\\]\n其中\\(S_C^2=\\frac {(n_1-1)S_1^2+(n_2-1)S_2^2}{n_1+n_2-2}\\)是\\(S_1^2\\)和\\(S_2^2\\)的加权平均，也称为合并样本方差（pooled sample variance）\n总体均值的置信区间（confidence interval）：\\(\\bar X_1-\\bar X_2 \\pm t_{\\nu,1-\\alpha/2} S_{\\bar X_1-\\bar X_2}\\)\n\n\n方差不等的未知正态分布\n\\[\nt'=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2}}}\\sim t(\\nu ')\n\\]\n其中 \\[\nv'=\\frac{(\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2})^2}{\\frac{(\\frac{S_1^2}{n_1})^2}{n_1-1}+\\frac{(\\frac{S_2^2}{n_2})^2}{n_2-1}}(舍入到最近整数)\n\\]\n总体均值的置信区间（confidence interval）：\\(\\bar X_1-\\bar X_2 \\pm t_{\\nu ',1-\\alpha/2} \\sqrt{\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2}}\\)\n\n\n\n\n5.2.2 方差之比的估计\n\n5.2.2.1 点估计\n\\[X_1\\sim N(\\mu_1,\\sigma_1^2)\\]\n\\[X_2\\sim N(\\mu_2,\\sigma_2^2)\\]\n统计量\\(S_1^2/S_2^2\\)是\\(\\sigma_1^2/\\sigma_2^2\\)的MVUE。\n\n\n5.2.2.2 区间估计\n\\[\nF=\\frac{\\frac {(n_1-1)S_1^2}{\\sigma_1^2}/(n_1-1)}{\\frac {(n_2-1)S_2^2}{\\sigma_2^2}/(n_2-1)}=(\\frac{S_1^2}{S_2^2})(\\frac{\\sigma_2^2}{\\sigma_1^2})\\sim F(\\nu_1,\\nu_2),\\nu_1=n_1-1,\\nu_2=n_2-1\n\\] 对于给定的\\(\\alpha\\)，称\\(F_{(\\nu_1,\\nu_2),\\alpha/2}\\)和\\(F_{(\\nu_1,\\nu_2),1-\\alpha/2}\\)为临界值（critical value）。\\(F_{(\\nu_1,\\nu_2),\\alpha/2}=\\frac{1}{F_{(\\nu_1,\\nu_2),1-\\alpha/2}}\\)\n总体方差的置信区间（confidence interval）：\\([\\frac{S_1^2}{S_2^2}\\times \\frac{1}{F_{(\\nu_1,\\nu_2),1-\\alpha/2}},\\frac{S_1^2}{S_2^2}\\times \\frac{1}{F_{(\\nu_1,\\nu_2),\\alpha/2}}]\\)\n\n\n\n5.2.3 率差异的估计\n\n5.2.3.1 点估计\n当\\(n_ip_i(1-p_i)≥5,(i=1,2)\\)时，\\(p_i\\dot\\sim N(\\pi_i,\\frac{\\pi_i(1-\\pi_i)}{n_i})\\)\n\\(E(p_1-p_2)=\\pi_1-\\pi_2\\)\n\\(Var(p_1-p_2)=\\frac{\\pi_1(1-\\pi_1)}{n_1}+\\frac{\\pi_2(1-\\pi_2)}{n_2}\\)\n统计量\\(p_1-p_2\\)是\\(\\pi_1-\\pi_2\\)的MVUE。\n\n\n5.2.3.2 区间估计\n\\[\n(p_1-p_2)\\dot\\sim N(\\pi_1-\\pi_2,\\frac{\\pi_1(1-\\pi_1)}{n_1}+\\frac{\\pi_2(1-\\pi_2)}{n_2})\n\\] 标准化变换 \\[\nZ=\\frac{(p_1-p_2)-(\\pi_1-\\pi_2)}{S_{p_1-p_2}}\\dot\\sim N(0,1)\n\\] 其中\\(S_{p_1-p_2}=\\sqrt{\\frac{p_1(1-p_1)}{n_1}+\\frac{p_2(1-p_2)}{n_2}}\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>参数估计</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html",
    "href": "hypothesis_testing.html",
    "title": "\n6  假设检验\n",
    "section": "",
    "text": "6.1 标准流程",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#标准流程",
    "href": "hypothesis_testing.html#标准流程",
    "title": "\n6  假设检验\n",
    "section": "",
    "text": "建立假设和确定显著性水平\n\nnull hypothesis：\\(H_0\\)\n\nalternative hypothesis：\\(H_1\\)\n\n显著性水平/犯第\\(Ⅰ\\)类错误（拒绝真\\(H_0\\)）的概率/拒绝域的概率：\\(α\\)\n\n\n\n选择检验方法和计算检验统计量\n\n\n\\(z\\)检验，\\(t\\)检验，\\(\\chi^2\\)检验，\\(F\\)检验，非参数检验等\n\n\n根据P值做出统计推断\n\np≤α，拒绝\\(H_0\\)，接受\\(H_1\\)\n\np＞α，不拒绝\\(H_0\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#功效分析",
    "href": "hypothesis_testing.html#功效分析",
    "title": "\n6  假设检验\n",
    "section": "\n6.2 功效分析",
    "text": "6.2 功效分析\n\n第\\(Ⅰ\\)类错误：拒绝真\\(H_0\\)，犯第Ⅰ类错误的概率\\(\\alpha=P(reject\\  H_0|H_0\\ is\\ True)\\)\n第\\(Ⅱ\\)类错误：不拒绝假\\(H_0\\)，犯第Ⅱ类错误的概率\\(\\beta=(not\\ reject\\  H_0|H_1\\ is\\ True)\\)\n功效 \\(power=1-β=P(reject\\  H0|H1 \\ is\\  True)\\)\n效应值 effect size 备择假设下的效应值\n样本量 sample size",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#假设检验与区间估计",
    "href": "hypothesis_testing.html#假设检验与区间估计",
    "title": "\n6  假设检验\n",
    "section": "\n6.3 假设检验与区间估计",
    "text": "6.3 假设检验与区间估计\n如果参数\\(θ\\)的\\((1-α)×100\\%\\)置信区间CI包含参数\\(\\theta_0\\)所有的估计值，那么不拒绝\\(H_0\\);\n如果参数\\(θ\\)的\\((1-α)×100\\%\\)置信区间CI不包含参数\\(\\theta_0\\)任意一个估计值，那么拒绝\\(H_0\\);\np value 和 CI 对于统计推断同等重要，尤其是大样本量。",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#一个总体的假设检验",
    "href": "hypothesis_testing.html#一个总体的假设检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.4 一个总体的假设检验",
    "text": "6.4 一个总体的假设检验\n\n6.4.1 均值——单样本\\(t\\)检验\n\\[t=\\frac{\\bar x-\\mu_0}{S /\\sqrt n} \\sim t(\\nu) \\]\n它是一种参数检验，用于检验小样本（n＜30）的均值是否可以合理地为特定值。\n\nCodeset.seed(100)\nx &lt;- rnorm(30, mean = 10, sd = 0.5)\nt.test(x, mu=10) \n#&gt; \n#&gt;  One Sample t-test\n#&gt; \n#&gt; data:  x\n#&gt; t = 0.22522, df = 29, p-value = 0.8234\n#&gt; alternative hypothesis: true mean is not equal to 10\n#&gt; 95 percent confidence interval:\n#&gt;   9.883375 10.145489\n#&gt; sample estimates:\n#&gt; mean of x \n#&gt;  10.01443\nt.test(x, mu=11) \n#&gt; \n#&gt;  One Sample t-test\n#&gt; \n#&gt; data:  x\n#&gt; t = -15.38, df = 29, p-value = 1.757e-15\n#&gt; alternative hypothesis: true mean is not equal to 11\n#&gt; 95 percent confidence interval:\n#&gt;   9.883375 10.145489\n#&gt; sample estimates:\n#&gt; mean of x \n#&gt;  10.01443\n\n\n单样本\\(Z\\)检验功效分析\n\n\n双侧假设\n功效(power) \\(1-β\\approx\\Phi(z_{\\alpha/2}+ES\\sqrt n)\\)\n效应值(effect size) \\(ES=\\frac{|\\mu_1-\\mu_2|}{\\sigma}\\)\n样本量 \\(n=\\frac{(z_{1-\\alpha/2}+z_{1-\\beta})^2}{ES^2}\\)\n\n\n单侧假设\n功效(power) \\(1-β=\\Phi(z_{\\alpha}+ES\\sqrt n)\\)\n效应值(effect size) \\(ES=\\frac{|\\mu_1-\\mu_2|}{\\sigma}\\)\n样本量 \\(n=\\frac{(z_{1-\\alpha}+z_{1-\\beta})^2}{ES^2}\\)\n\n\n6.4.2 率——\\(Z\\)检验\n\\[\nZ=\\frac{p-\\pi_0}{\\sqrt{\\pi_0(1-\\pi_0)/n}}\\sim N(0,1)\n\\] 连续校正 \\[\nZ_{corr}=\\frac{|p-\\pi_0|-1/(2n)}{\\sqrt{\\pi_0(1-\\pi_0)/n}}\\sim N(0,1)\n\\] 功效分析\n功效 \\(1-β\\approx\\Phi(\\sqrt{\\frac{\\pi_0(1-\\pi_0)}{\\pi_1(1-\\pi_1)}}(z_{\\alpha/2}+\\frac{|\\pi_1-\\pi_0|\\sqrt n}{\\sqrt{\\pi_0(1-\\pi_0)}}))\\)\n样本量 \\(n=\\frac{\\pi_0(1-\\pi_0))}{(\\pi_1-\\pi_0)^2}(z_{1-\\alpha/2}+z_{1-\\beta}\\sqrt{\\frac{\\pi_0(1-\\pi_0)}{\\pi_1(1-\\pi_1)}})\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "hypothesis_testing.html#两个总体的假设检验",
    "href": "hypothesis_testing.html#两个总体的假设检验",
    "title": "\n6  假设检验\n",
    "section": "\n6.5 两个总体的假设检验",
    "text": "6.5 两个总体的假设检验\n\n6.5.1 配对样本的均值差异——t检验\n\\[\nH_0:\\mu_{\\bar d}=0\n\\] \\[\nt=\\frac{\\bar d- \\mu_{\\bar d}}{S_d /\\sqrt n} \\sim t(\\nu)\n\\] 其中\\(d= X_2-X_1,\\mu_{\\bar d}=0\\)。\n\nCodedf &lt;- tribble(\n    ~id,~baseline,~ten_days_later,~d,\n    1,58.27,120.61,62.34,\n    2,59.51,126.33,66.82,\n    3,53.84,108.35,54.51,\n    4,54.70,139.99,85.29,\n    5,54.03,115.29,61.26,\n    6,61.29,146.96,85.67,\n    7,54.72,115.64,60.92,\n    8,70.43,124.62,54.19,\n    9,66.45,121.40,54.95,\n    10,59.31,134.81,75.50,\n    11,63.48,130.73,67.25,\n    12,67.19,118.37,51.18,\n    13,52.92,129.28,76.36,\n    14,71.99,117.40,45.41\n)\nd_mean &lt;- mean(df$d)\nd_sd &lt;- sd(df$d)\nd_se &lt;- d_sd/sqrt(length(df$d))\nt_statistic &lt;- d_mean/d_se\n\n\nt.test(df$ten_days_later,df$baseline,paired = TRUE)\n#&gt; \n#&gt;  Paired t-test\n#&gt; \n#&gt; data:  df$ten_days_later and df$baseline\n#&gt; t = 19.322, df = 13, p-value = 5.866e-11\n#&gt; alternative hypothesis: true mean difference is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  57.20275 71.60440\n#&gt; sample estimates:\n#&gt; mean difference \n#&gt;        64.40357\nt.test(Pair(df$ten_days_later,df$baseline)~1,data=df)\n#&gt; \n#&gt;  Paired t-test\n#&gt; \n#&gt; data:  Pair(df$ten_days_later, df$baseline)\n#&gt; t = 19.322, df = 13, p-value = 5.866e-11\n#&gt; alternative hypothesis: true mean difference is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  57.20275 71.60440\n#&gt; sample estimates:\n#&gt; mean difference \n#&gt;        64.40357\n\n\n\n6.5.2 两独立样本的均值差异\n\n6.5.2.1 方差相等——t检验\n\\[H_0:\\mu_1-\\mu_2=0\\]\n\\[\nt=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{S_{\\bar X_1-\\bar X_2}}=\\frac{\\bar X_1-\\bar X_2}{\\sqrt{S_C^2(\\frac{1}{n_1}+\\frac{1}{n_2})}}\n\\]\n\nCodedf2 &lt;- tibble(\n    experimental=c(120.61 ,126.33 ,108.35 ,139.99 ,115.29 ,146.96 ,115.64,\n                   124.62 ,121.40 ,134.81 ,130.73 ,118.37 ,129.28 ,117.45),\n    control=c(58.23 ,54.50 ,59.47 ,59.64 ,53.77 ,43.48 ,\n              54.63 ,71.91 ,53.97 ,49.72 ,61.26 ,78.17,NA,NA)\n)\n\ne_mean &lt;- mean(df2$experimental)\ne_sd &lt;- sd(df2$experimental)\nn1 &lt;- length(df2$experimental)\n\nctrl_mean &lt;- mean(df2$control,na.rm = TRUE)\nctrl_sd &lt;- sd(df2$control,na.rm = TRUE)\nn2 &lt;- length(df2$control)-sum(is.na(df2$control))\n\nSc_2 &lt;- ((n1-1)*e_sd^2+(n2-1)*ctrl_sd^2)/(n1+n2-2)\n\nt2 &lt;- (e_mean-ctrl_mean)/sqrt(Sc_2*(1/14+1/12))\n\nt.test(df2$experimental,df2$control,var.equal = TRUE)\n#&gt; \n#&gt;  Two Sample t-test\n#&gt; \n#&gt; data:  df2$experimental and df2$control\n#&gt; t = 16.967, df = 24, p-value = 7.215e-15\n#&gt; alternative hypothesis: true difference in means is not equal to 0\n#&gt; 95 percent confidence interval:\n#&gt;  58.63784 74.87954\n#&gt; sample estimates:\n#&gt; mean of x mean of y \n#&gt; 124.98786  58.22917\n\n\n\n6.5.2.2 方差是否相等——F检验\n\\[H_0:\\frac{\\sigma_1^2}{\\sigma_2^2}=1\\]\n\\[\nF=\\frac{\\frac {(n_1-1)S_1^2}{\\sigma_1^2}/(n_1-1)}{\\frac {(n_2-1)S_2^2}{\\sigma_2^2}/(n_2-1)}=(\\frac{S_1^2}{S_2^2})(\\frac{\\sigma_2^2}{\\sigma_1^2})=\\frac{S_1^2}{S_2^2}\\sim F(\\nu_1,\\nu_2),\\nu_1=n_1-1,\\nu_2=n_2-1\n\\]\n\nCodeF_stats &lt;- (e_sd^2)/(ctrl_sd^2)\n\n# 检验两个样本的方差是否相等\nvar.test(df2$experimental,df2$control)\n#&gt; \n#&gt;  F test to compare two variances\n#&gt; \n#&gt; data:  df2$experimental and df2$control\n#&gt; F = 1.287, num df = 13, denom df = 11, p-value = 0.6831\n#&gt; alternative hypothesis: true ratio of variances is not equal to 1\n#&gt; 95 percent confidence interval:\n#&gt;  0.3794599 4.1152566\n#&gt; sample estimates:\n#&gt; ratio of variances \n#&gt;           1.287025\n\n\n\n6.5.2.3 方差不等—— Approximation t 检验\n\\[H_0:\\mu_1-\\mu_2=0\\]\n\\[\nt'=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2}}}=\\frac{\\bar X_1-\\bar X_2}{\\sqrt{\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2}}}\\sim t(\\nu ')\n\\]\nCochran & Cox Approximation t-test\n强调方差的变异\n因为\\(t'\\)既不遵循t分布，也不遵循正态分布，因此t’的临界值需要特定的计算方法。\n\\[\nt'_{\\alpha/2}=\\frac{S^2_{\\bar X_1}t_{\\nu_1,\\alpha/2}+S^2_{\\bar X_2}t_{\\nu_2,\\alpha/2}}{S^2_{\\bar X_1}+S^2_{\\bar X_2}}\n\\]\n\\[\nt'_{1-\\alpha/2}=\\frac{S^2_{\\bar X_1}t_{\\nu_1,1-\\alpha/2}+S^2_{\\bar X_2}t_{\\nu_2,1-\\alpha/2}}{S^2_{\\bar X_1}+S^2_{\\bar X_2}}\n\\] 其中\\(\\nu_1=n_1-1,\\nu_2=n_2-1,t_{\\nu_1,1-\\alpha/2}和t_{\\nu_2,1-\\alpha/2}\\)分别是\\(t_{\\nu_1}和t_{\\nu_2}\\)的临界值。\n因为t分布是对称的，\\(t_{\\nu,\\alpha/2}=-t_{\\nu,1-\\alpha/2}\\)，所以\\(t'_{\\alpha/2}=t'_{1-\\alpha/2}\\)。\nSatterthwaite Approximation t-test\n强调自由度\n\\[\nv'=\\frac{(\\frac{S_1^2}{n_1}+\\frac{S_2^2}{n_2})^2}{\\frac{(\\frac{S_1^2}{n_1})^2}{n_1-1}+\\frac{(\\frac{S_2^2}{n_2})^2}{n_2-1}}(舍入到最近整数)\n\\]\n\n6.5.2.4 大样本量—— Z检验\n当\\(n_1＞30\\ \\&\\ n_2＞30\\)时，\n\\[\n\\bar X_1\\dot\\sim N(\\mu_1,\\frac{\\sigma^2_1}{n_1})\n\\]\n\\[\n\\bar X_2\\dot\\sim N(\\mu_2,\\frac{\\sigma^2_2}{n_2})\n\\]\n\\[H_0:\\mu_1-\\mu_2=0\\]\n\\[\nZ=\\frac{(\\bar X_1-\\bar X_2)-(\\mu_1-\\mu_2)}{\\sqrt{\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}}}=\\frac{\\bar X_1-\\bar X_2}{\\sqrt{\\frac{\\sigma^2_1}{n_1}+\\frac{\\sigma^2_2}{n_2}}}\\dot\\sim N(0,1)\n\\]\n\n6.5.2.5 功效分析\n功效(power) \\(1-β\\approx\\Phi(-z_{1-\\alpha/2}+\\frac{|\\mu_1-\\mu_2|}{\\sqrt {\\sigma_1^2/n_1+\\sigma_2^2/n_2}})\\)\n样本量\n\n两组样本量相等 \\[\nn=\\frac{(\\sigma_1^2+\\sigma_1^2)(z_{1-\\alpha/2}+z_{1-\\beta})^2}{(\\mu_1-\\mu_2)^2}\n\\]\n\n两组样本量不等（\\(n_2=kn_1\\)） \\[\nn_1=\\frac{(\\sigma_1^2+\\sigma_1^2/k)(z_{1-\\alpha/2}+z_{1-\\beta})^2}{(\\mu_1-\\mu_2)^2}\n\\]\n\\[\nn_2=\\frac{(k\\sigma_1^2+\\sigma_1^2)(z_{1-\\alpha/2}+z_{1-\\beta})^2}{(\\mu_1-\\mu_2)^2}\n\\]\n\n\n6.5.3 两总体率的差异——z检验\n当\\(n_ip_i(1-p_i)≥5,(i=1,2)\\)时，\\(p_i\\dot\\sim N(\\pi_i,\\frac{\\pi_i(1-\\pi_i)}{n_i})\\)\n\\[\n(p_1-p_2)\\dot\\sim N(\\pi_1-\\pi_2,\\frac{\\pi_1(1-\\pi_1)}{n_1}+\\frac{\\pi_2(1-\\pi_2)}{n_2})\n\\]\n\\(H_0:\\pi_1=\\pi_2\\)\n\\[\nZ=\\frac{(p_1-p_2)-(\\pi_1-\\pi_2)}{S_{p_1-p_2}}=\\frac{p_1-p_2}{\\sqrt{p_C(1-p_C)(\\frac{1}{n_1}+\\frac{1}{n_2})}}\\dot\\sim N(0,1)\n\\]\n其中\\(p_C=\\frac{n_1p_1+n_2p_2}{n_1+n_2}\\)\n功效分析\n\n\\(1-\\beta\\)\n\\(n1,n_2=kn_1\\)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>假设检验</span>"
    ]
  },
  {
    "objectID": "ANOVA.html",
    "href": "ANOVA.html",
    "title": "\n7  方差分析\n",
    "section": "",
    "text": "7.1 单因素组间方差分析",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "ANOVA.html#单因素组间方差分析",
    "href": "ANOVA.html#单因素组间方差分析",
    "title": "\n7  方差分析\n",
    "section": "",
    "text": "7.1.1 多样本均值差异——F检验\n\n\n\n\n因子A有\\(A_1,A_2,...,A_k\\)共k个水平\ntotal sum of squares\n\\[\nSS_T=\\sum_{j=1}^{k}\\sum_{i=1}^{n_j}X_{ij}^2-\\frac{(\\sum_{j=1}^{k}\\sum_{i=1}^{n_j}X_{ij})^2}{n}=SS_{组间}+SS_{组内}\n\\]\nbetween groups sum of squares \\[\nSS_{组间}=\\sum_{j=1}^{k}\\frac{(\\sum_{i=1}^{n_j}X_{ij})^2}{n_j}-\\frac{(\\sum_{j=1}^{k}\\sum_{i=1}^{n_j}X_{ij})^2}{n}\n\\]\n自由度\\(\\nu=n-1,\\nu_{组间}=k-1,\\nu_{组内}=\\sum_{j=1}^{k}(n_j-1)=n-k\\)\nBetween groups mean square \\(MS_{组间}=\\frac{SS_{组间}}{k-1}\\)\nWithin groups mean square \\(MS_{组内}=\\frac{SS_{组内}}{n-k}\\)\n\\[H_0:\\mu_1=\\mu_2=...=\\mu_k\\]\n\\[\n\\frac{SS_T}{\\sigma^2}\\sim \\chi^2(\\nu),\\nu=n-1\n\\] \\[\n\\frac{SS_{组内}}{\\sigma^2}\\sim \\chi^2(\\nu),\\nu=n-k\n\\] 因此，\n\\[\n\\frac{SS_{组间}}{\\sigma^2}=\\frac{SS_T}{\\sigma^2}-\\frac{SS_{组内}}{\\sigma^2}\\ \\ \\ \\sim \\chi^2(\\nu),\\nu=k-1\n\\]\n检验统计量\n\\[\nF=\\frac{\\frac{SS_{组间}}{(k-1)\\sigma^2}}{\\frac{SS_{组内}}{(n-k)\\sigma^2}}=\\frac{\\frac{SS_{组间}}{k-1}}{\\frac{SS_{组内}}{n-k}}=\\frac{MS_{组间}}{MS_{组内}}\\ \\ \\ \\sim \\chi^2(\\nu),\\nu=k-1\n\\]\n\n\n\n\n\nCodedf &lt;- tibble(\n    low=c(53.5,43.7,46.5,50.3,56.1),\n    medium=c(33.2,30.6,23.9,26.4,35.9),\n    high=c(11.5,21.9,18.6,13.6,9.5)\n)\nk &lt;- 3\ndf_sum &lt;- sum(df)\ndf_sum_square &lt;- sum(df^2)\nn &lt;- 15\nC &lt;- df_sum^2/n\n\nSS_T &lt;- df_sum_square-C\nSS_between &lt;- apply(df, 2, function(x) sum(sum(x)^2/length(x))) |&gt; sum()-C\n\nSS_within &lt;- SS_T-SS_between\n\nMS_between &lt;- SS_between/(k-1)\nMS_within &lt;- SS_within/(n-k)\nF_stat &lt;-MS_between/MS_within \n\n\n\nCodedf_long &lt;- df |&gt; pivot_longer(cols = everything(),\n                              names_to = \"level\",\n                              values_to = \"value\")\ndf_long$level &lt;- factor(df_long$level)\ndf_aov &lt;- aov(value~level,data = df_long)\n\nsummary(df_aov)\n#&gt;             Df Sum Sq Mean Sq F value   Pr(&gt;F)    \n#&gt; level        2 3083.7  1541.8   61.24 5.05e-07 ***\n#&gt; Residuals   12  302.1    25.2                     \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n# 异常观测点\n\ncar::outlierTest(df_aov) \n#&gt; No Studentized residuals with Bonferroni p &lt; 0.05\n#&gt; Largest |rstudent|:\n#&gt;   rstudent unadjusted p-value Bonferroni p\n#&gt; 6  1.63682            0.12993           NA\n\n\n\n7.1.2 均值的多重比较\n成对比较的数量 \\(N=\\frac{k!}{2!(k-2)!},k≥3\\)，导致犯第Ⅰ类错误的概率迅速增加，\\([1-(1-\\alpha)^N]\\)。\n\n7.1.2.1 Tukey’s test\nTukey’s test 也被称为Tukey’s honestly significant difference (Tukey’s HSD) test。\n\nk个均值从大到小排列；\n均值最大的组依次与均值最小，第二小，……，第二大比较；\n均值第二大的组以同样的方式比较；\n以此类推\n在各组样本量相等的情况下，如果在两个均值之间未发现显著差异，则推断这两个均值所包含的任何均值之间不存在显著差异，并且不再检验所包含均值之间的差异。\n\nstudentized range statistic \\(q=\\frac{\\bar X_{max}-\\bar X_{min}}{S_{\\bar X_{max}-\\bar X_{min}}}\\)，其中\\(S_{\\bar X_{max}-\\bar X_{min}}=\\sqrt{\\frac{MS_{组内}}{n}}\\)，\\(n\\)是每一个治疗组的样本量。\n如果各组样本量不等,则\\(S_{\\bar X_{max}-\\bar X_{min}}=\\sqrt{\\frac{MS_{组内}}{2}(\\frac{1}{n_i}+\\frac{1}{n_j})}\\)\n检验统计量\n\\[\nHSD=q_{(k,\\nu_{组内}),1-\\alpha} \\times S_{\\bar X_{max}-\\bar X_{min}},\\nu_{组内}=k(n_j-1)\n\\]\n对于任意i,j且\\(\\bar X_i＞\\bar X_j\\)，如果\\(\\bar X_i-\\bar X_j＞HSD\\)，那么拒绝\\(H_0\\)，说明这两组存在显著差异。\n\\[\nH_0:\\mu_i=\\mu_j(i≠j)\n\\]\n\nCodek_means &lt;- apply(df,2,mean) |&gt; sort(,decreasing = TRUE)\nk_means\n#&gt;    low medium   high \n#&gt;  50.02  30.00  15.02\n\n# 附录q  q(3,12),1-0.05  3(5-1)=12\nq_critical_value &lt;- 3.77\nnj &lt;- 5\nHSD &lt;- q_critical_value*sqrt(MS_within/nj)\n\nk_means\n#&gt;    low medium   high \n#&gt;  50.02  30.00  15.02\ndiff_means &lt;- c()\nnames_diff_means &lt;- c()\n\nfor(i in 1:(length(k_means)-1)){\n    for(j in length(k_means):(i+1)){\n        diff_value &lt;- k_means[i] - k_means[j]\n        diff_means &lt;- c(diff_means, diff_value)\n        names_diff_means &lt;- c(names_diff_means, paste(names(k_means)[i], \"vs.\", names(k_means)[j],sep = \"_\"))\n    }\n}\nnames(diff_means) &lt;- names_diff_means\ndiff_means\n#&gt;    low_vs._high  low_vs._medium medium_vs._high \n#&gt;           35.00           20.02           14.98\n#全为真，3组成对比较都存在显著差异\ndiff_means &gt; HSD \n#&gt;    low_vs._high  low_vs._medium medium_vs._high \n#&gt;            TRUE            TRUE            TRUE\n\n\n\nCodepairwise &lt;- TukeyHSD(df_aov)\npairwise\n#&gt;   Tukey multiple comparisons of means\n#&gt;     95% family-wise confidence level\n#&gt; \n#&gt; Fit: aov(formula = value ~ level, data = df_long)\n#&gt; \n#&gt; $level\n#&gt;               diff        lwr       upr     p adj\n#&gt; low-high     35.00  26.534054  43.46595 0.0000003\n#&gt; medium-high  14.98   6.514054  23.44595 0.0013315\n#&gt; medium-low  -20.02 -28.485946 -11.55405 0.0001069\n\n\n\n7.1.2.2 Dunnett’s test\nDunnett’s test也称为q’-test,是两独立样本t-test的一种修正。Dunnett’s test 假设数据符合正态分布，并且各组的方差相等。 控制对照组（C）与其他每个实验组（T）比较。\n\\(H_0:\\mu_C=\\mu_T\\)\n\\[\nq'=\\frac{\\bar X_T-\\bar X_C}{\\sqrt{MS_{组内}(\\frac{1}{n_T}+\\frac{1}{n_C})}} \\sim q'(\\nu,a) \\ \\ \\nu=\\nu_{组内},a=k\n\\]\n临界值 \\(q'_{(a,\\nu_E),1-\\alpha/2}\\)\n\nCodenT &lt;- nC &lt;- 5 \n\nSE_mean_diff &lt;- sqrt(MS_within*(1/nT+1/nC))\n\nk_means\n#&gt;    low medium   high \n#&gt;  50.02  30.00  15.02\ndiff_means &lt;- c()\nnames_diff_means &lt;- c()\n\n# 以 low 作控制组\nfor(i in 2:length(k_means)){\n        diff_value &lt;- k_means[i] - k_means[1]\n        diff_means &lt;- c(diff_means, diff_value)\n        names_diff_means &lt;- c(names_diff_means, paste(names(k_means)[1], \"vs.\", names(k_means)[i],sep = \"_\"))\n}\nnames(diff_means) &lt;- names_diff_means\ndiff_means\n#&gt; low_vs._medium   low_vs._high \n#&gt;         -20.02         -35.00\n\nq撇_stat &lt;- diff_means/SE_mean_diff\n\n# 附录q'  q'(3,12),1-0.05/2  \nabs(q撇_stat)&gt;2.50  \n#&gt; low_vs._medium   low_vs._high \n#&gt;           TRUE           TRUE\n#全为真，各实验组与控制组均存在显著差异\n\n\n\nCodelibrary(multcomp)\ndunnett_result &lt;- glht(df_aov, linfct =mcp(level =c(\"medium - low = 0\", \"high - low = 0\")))\n\n# 查看 Dunnett's test 结果\nsummary(dunnett_result)\n#&gt; \n#&gt;   Simultaneous Tests for General Linear Hypotheses\n#&gt; \n#&gt; Multiple Comparisons of Means: User-defined Contrasts\n#&gt; \n#&gt; \n#&gt; Fit: aov(formula = value ~ level, data = df_long)\n#&gt; \n#&gt; Linear Hypotheses:\n#&gt;                   Estimate Std. Error t value Pr(&gt;|t|)    \n#&gt; medium - low == 0  -20.020      3.173  -6.309 7.46e-05 ***\n#&gt; high - low == 0    -35.000      3.173 -11.030 2.38e-07 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; (Adjusted p values reported -- single-step method)\n\n\n\n7.1.2.3 LSD-t test\nleast significant difference t-test\n挑选任意感兴趣的两组进行比较\n\\[\nH_0:\\mu_i=\\mu_j(i≠j)\n\\]\n\\[\nLSD-t=\\frac{\\bar X_i-\\bar X_j}{\\sqrt{MS_{组内}(\\frac{1}{n_i}+\\frac{1}{n_j})}} \\sim t(\\nu) \\ ,\\ \\nu=\\nu_{组内}=n-k,a=k\n\\]\n\nCode# medium high\nLSD &lt;- (k_means[2]-k_means[3])/sqrt(MS_within*(1/5+1/5))\n\n# 附录 t(12,1-0.05/2)=2.719\n\n\n\n7.1.3 方差分析的假设是否成立\n\n7.1.3.1 独立性\n\n7.1.3.2 正态性\n直方图/茎叶图\nP-P图/Q-Q图\n偏度和峰度\n\\[\nH_0:总体偏度系数\\gamma_1=0 或者总体峰度系数\\gamma_2=0\n\\]\n\\[\nz_i=\\frac{g_i-0}{\\sigma_{g_i}}  \\ \\ \\ \\ 临界值z_{1-\\alpha/2}\n\\]\nShapiro-Wilk检验（小样本）\n\nCodeshapiro.test(df$low)  \n#&gt; \n#&gt;  Shapiro-Wilk normality test\n#&gt; \n#&gt; data:  df$low\n#&gt; W = 0.9718, p-value = 0.8867\nshapiro.test(df$medium)  \n#&gt; \n#&gt;  Shapiro-Wilk normality test\n#&gt; \n#&gt; data:  df$medium\n#&gt; W = 0.96762, p-value = 0.8598\nshapiro.test(df$high)  \n#&gt; \n#&gt;  Shapiro-Wilk normality test\n#&gt; \n#&gt; data:  df$high\n#&gt; W = 0.94361, p-value = 0.6916\n\n# 因为观测太少，也可以同时检验\nshapiro.test(c(df$low,df$medium,df$high))  \n#&gt; \n#&gt;  Shapiro-Wilk normality test\n#&gt; \n#&gt; data:  c(df$low, df$medium, df$high)\n#&gt; W = 0.94559, p-value = 0.4578\n\n\nKolmogorov-Smirnov检验（Lilliefors correction 大样本）\n\nCodeks.test(c(df$low,df$medium,df$high),\"pnorm\")\n#&gt; \n#&gt;  Exact one-sample Kolmogorov-Smirnov test\n#&gt; \n#&gt; data:  c(df$low, df$medium, df$high)\n#&gt; D = 1, p-value &lt; 2.2e-16\n#&gt; alternative hypothesis: two-sided\nks.test(rnorm(1000),\"pnorm\")\n#&gt; \n#&gt;  Asymptotic one-sample Kolmogorov-Smirnov test\n#&gt; \n#&gt; data:  rnorm(1000)\n#&gt; D = 0.032701, p-value = 0.2352\n#&gt; alternative hypothesis: two-sided\n\n\n\nCodex &lt;- rnorm(50) \ny &lt;- runif(50) \nks.test(x, y)  # perform ks test\n#&gt; \n#&gt;  Exact two-sample Kolmogorov-Smirnov test\n#&gt; \n#&gt; data:  x and y\n#&gt; D = 0.54, p-value = 4.929e-07\n#&gt; alternative hypothesis: two-sided\n\nx &lt;- rnorm(50)\ny &lt;- rnorm(50)\nks.test(x, y) \n#&gt; \n#&gt;  Exact two-sample Kolmogorov-Smirnov test\n#&gt; \n#&gt; data:  x and y\n#&gt; D = 0.12, p-value = 0.8693\n#&gt; alternative hypothesis: two-sided\n\n\n\n7.1.3.3 方差齐性\nBartlett’s test\n数据满足正态性\n比较每一组方差的加权算术均值和几何均值。\n\\[\nH_0:\\sigma_1^2=\\sigma_2^2=...=\\sigma_k^2\n\\] 当样本量\\(n_j\\)≥5时，检验统计量(各组样本量相等)\n\\[\nB=\\frac{(n-1)[kln\\bar S^2-\\sum_{j=1}^{k}lnS_j^2]}{1+\\frac{k+1}{3k(n-1)}} \\sim\\ \\chi^2(\\nu)\\ ,\\nu=k-1\n\\] 其中n是每一组的样本量，\\(S_j^2\\)是某一组的样本方差，\\(\\bar S^2\\)是所有k个组样本方差的平均值。\n当各组样本量不等时，\n\\[\nB=\\frac{\\sum_{j=1}^{k}(n_j-1)ln\\frac{\\bar S^2}{S_j^2}}{1+\\frac{1}{3(k-1)}(\\sum_{j=1}^{k}\\frac {1}{n_j-1}-\\frac{1}{\\sum_{j=1}^{k}(n_j-1)})} \\sim\\ \\chi^2(\\nu)\\ ,\\nu=k-1\n\\] 其中\\(h_j\\)是某一组的样本量，\\(\\bar S^2=(\\sum_{j=1}^{k}(n_j-1)S_j^2)/(\\sum_{j=1}^{k}(n_j-1))\\)是所有k个组样本方差的加权平均值。\n\nCoden1=n2=n3=5\nk=3\nS2 &lt;- apply(df,2,var)\nS2\n#&gt;    low medium   high \n#&gt; 25.372 23.895 26.257\n\nlnS2 &lt;- log(S2)\nlnS2\n#&gt;      low   medium     high \n#&gt; 3.233646 3.173669 3.267933\n\nS2_mean &lt;- (5-1)*(sum(S2))/(3*(5-1))\nS2_mean\n#&gt; [1] 25.17467\n\n\n\nB &lt;- ((5-1)*(3*log(S2_mean)-sum(lnS2)))/(1+(3+1)/(3*3*(5-1)))\nB\n#&gt; [1] 0.008159536\n\n\n\nCodebartlett.test(df)\n#&gt; \n#&gt;  Bartlett test of homogeneity of variances\n#&gt; \n#&gt; data:  df\n#&gt; Bartlett's K-squared = 0.0081595, df = 2, p-value = 0.9959\n\n\nLevene’s test\n数据不满足正态性\n\nk个随机样本是独立的\n随机变量X是连续的\n\nLevene 变换：\n\\[\nZ_{ij}=|X_{ij}-\\bar X_{.\\ j}|(i=1,2...,n_j;\\ j=1,2,...,k)\n\\]\n\nCodeoptions(digits = 2)\nz_df &lt;- bind_cols(\n    low=df[1]-k_means[1],\n    medium=df[2]-k_means[2],\n    high=df[3]-k_means[3]\n) |&gt; abs()\n    \n\nz_df\n\n\n\n\nlow\nmedium\nhigh\n\n\n\n3.48\n3.2\n3.5\n\n\n6.32\n0.6\n6.9\n\n\n3.52\n6.1\n3.6\n\n\n0.28\n3.6\n1.4\n\n\n6.08\n5.9\n5.5\n\n\n\n\n\n\n检验统计量（基于变换后的F检验）\n\\[\nW=\\frac{MS_{组间}}{MS_{组内}}=\\frac{\\sum_jn_j(\\bar Z_{.j}-\\bar Z_{..})^2/(k-1)}{\\sum_j\\sum_i(Z_{ij}-\\bar Z_{.j})^2/(n-k)}  \\sim F(\\nu_1,\\nu_2)   \\ \\ \\ \\ \\nu_1=k-1,\\nu_2=n-k\n\\]\n\nCodev1=3-1\nv2=15-3\n\n\nz.j_mean &lt;- apply(z_df, 2, mean)\nz.j_mean\n#&gt;    low medium   high \n#&gt;    3.9    3.9    4.2\n\nz_mean &lt;- mean(z.j_mean)\nz_mean \n#&gt; [1] 4\n\noptions(digits = 4)\nW &lt;- 12*sum(5*(z.j_mean-z_mean)^2)/(2*(sum((z_df$low-z.j_mean[1])^2)+sum((z_df$medium-z.j_mean[2])^2)+sum((z_df$high-z.j_mean[3])^2)))\n\nW\n#&gt; [1] 0.0254\n\n\n\n7.1.3.4 数据变换\n当方差分析的正态性假设或方差齐性假设不为真时，通常使用(1)数据变换方法；(2)非参数检验方法 比较均值差异\n平方根变换\n当每个水平组的方差与均值成比例，尤其是样本来自泊松分布\n\\[\nY=\\sqrt{X}\n\\]\n当数据中有零或非常小的值时，\n\\[\nY=\\sqrt{X+a} \\ \\ \\ \\ a=0.5或0.1\n\\]\n对数变换\n当数据方差不齐且每个水平组标准差与均值成比例时\n\\[\nY=\\log{X} \\ \\ \\ \\ base=e或10\n\\]\n当数据中有零或负值时，\n\\[\nY=\\log{(X+a)} \\ \\ \\ \\ a为实数，使得X+a&gt;0\n\\]\n反正弦平方根变换\n率，服从二项分布\\(B(n,\\pi)\\)\n\\[\nY=\\arcsin {\\sqrt{\\pi}} \\ \\ \\ \\\n\\]",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "ANOVA.html#重复测量设计的方差分析单因素组内方差分析",
    "href": "ANOVA.html#重复测量设计的方差分析单因素组内方差分析",
    "title": "\n7  方差分析\n",
    "section": "\n7.2 重复测量设计的方差分析（单因素组内方差分析）",
    "text": "7.2 重复测量设计的方差分析（单因素组内方差分析）\n假设\n\n正态性\n方差齐性\n协方差矩阵的球形检验（W=1）\n\n\\[\nSS_T=\\sum_{j=1}^{t}\\sum_{i=1}^{n}X_{ij}^2-\\frac{(\\sum_{j=1}^{t}\\sum_{i=1}^{n}X_{ij})^2}{nt}=SS_{受试者组间}+SS_{时间组间}+SS_{随机误差}，\\nu_T=nt-1\n\\]\n\\[\nSS_{受试者组间}=\\frac{\\sum_{i}(\\sum_{j}X_{ij})^2}{t}-C，\\nu_{受试者}=n-1\n\\]反映了在受试者间的变异\n\\[\nSS_{时间组间}=\\frac{\\sum_{j}(\\sum_{i}X_{ij})^2}{n}-C ，\\nu_{时间点}=t-1\n\\]反映了在每个受试者内不同时间点的重复测量变异\n\\[\nSS_E=SS_T-SS_{受试者组间}-SS_{时间组间}，\\nu_E=(n-1)(t-1)\n\\]\n\\(H_0:\\mu_1=\\mu_2=...=\\mu_t\\)，检验统计量\n\\[\nF=\\frac{MS_{时间组间}}{MS_E}=\\frac{SS_{时间组间}/(t-1)}{SS_E/((n-1)(t-1))}\n\\]\n\nCodedf &lt;- tribble(\n    ~id,~zero,~ten,~twenty,~thirty,\n    1,186,122,134,110,\n    2,345,312,268,176,\n    3,98,84,52,61,\n    4,288,98,91,85,\n    5,176,86,130,99,\n    6,210,188,143,120,\n    7,271,322,86,65,\n    8,415,332,265,186,\n    9,171,126,130,135,\n    10,243,330,95,64,\n)\ndf_long &lt;- df |&gt; pivot_longer(cols = -1,names_to = \"week\",values_to = \"ALT\") |&gt; mutate(week=factor(week))\n\n\nxij_sum &lt;- sum(df_long$ALT)\nxij_square_sum &lt;- sum(df_long$ALT^2)\nC &lt;- xij_sum^2/40\nSS_T &lt;- xij_square_sum-C\n\n# 受试者间  \nxi._sum &lt;- rowSums(df[,-1])\nxi._sum\n#&gt;  [1]  552 1101  295  562  491  661  744 1198  562  732\nSS_B &lt;- sum(xi._sum^2)/4-C #行和平方和\nMS_B &lt;- SS_B/9\n\n# 不同时间点\nx.j_sum &lt;- colSums(df[,-1])\nx.j_sum\n#&gt;   zero    ten twenty thirty \n#&gt;   2403   2000   1394   1101\nSS_W &lt;- sum(x.j_sum^2)/10-C #列和平方和\nMS_W &lt;- SS_W/3\n\n\n\n\n\nSS_E &lt;- SS_T-SS_B-SS_W\nMS_E &lt;- SS_E/(9*3)\n\nF_stat &lt;- MS_W/MS_E\n\n\n\nCodelibrary(nlme)\nmodel &lt;- lme(ALT ~ week, random = ~1| id/week, data = df_long)\nsummary(model)\n#&gt; Linear mixed-effects model fit by REML\n#&gt;   Data: df_long \n#&gt;   AIC   BIC logLik\n#&gt;   431 442.1 -208.5\n#&gt; \n#&gt; Random effects:\n#&gt;  Formula: ~1 | id\n#&gt;         (Intercept)\n#&gt; StdDev:       62.83\n#&gt; \n#&gt;  Formula: ~1 | week %in% id\n#&gt;         (Intercept) Residual\n#&gt; StdDev:       50.69    22.92\n#&gt; \n#&gt; Fixed effects:  ALT ~ week \n#&gt;             Value Std.Error DF t-value p-value\n#&gt; (Intercept) 200.0     26.54 27   7.536  0.0000\n#&gt; weekthirty  -89.9     24.88 27  -3.613  0.0012\n#&gt; weektwenty  -60.6     24.88 27  -2.436  0.0217\n#&gt; weekzero     40.3     24.88 27   1.620  0.1169\n#&gt;  Correlation: \n#&gt;            (Intr) wkthrt wktwnt\n#&gt; weekthirty -0.469              \n#&gt; weektwenty -0.469  0.500       \n#&gt; weekzero   -0.469  0.500  0.500\n#&gt; \n#&gt; Standardized Within-Group Residuals:\n#&gt;      Min       Q1      Med       Q3      Max \n#&gt; -0.55744 -0.26472 -0.01207  0.19777  0.89725 \n#&gt; \n#&gt; Number of Observations: 40\n#&gt; Number of Groups: \n#&gt;           id week %in% id \n#&gt;           10           40\nanova_results &lt;- anova(model)\nanova_results\n\n\n\n\n\nnumDF\ndenDF\nF-value\np-value\n\n\n\n(Intercept)\n1\n27\n62.98\n0e+00\n\n\nweek\n3\n27\n11.14\n1e-04\n\n\n\n\n\nCode\n\nlibrary(multcomp)\nglht_result &lt;-glht(model, linfct = mcp(week =c(\"ten - zero = 0 \",\n                                               \"twenty - zero == 0\",\n                                               \"thirty - zero = 0 \")))\nsummary(glht_result)\n#&gt; \n#&gt;   Simultaneous Tests for General Linear Hypotheses\n#&gt; \n#&gt; Multiple Comparisons of Means: User-defined Contrasts\n#&gt; \n#&gt; \n#&gt; Fit: lme.formula(fixed = ALT ~ week, data = df_long, random = ~1 | \n#&gt;     id/week)\n#&gt; \n#&gt; Linear Hypotheses:\n#&gt;                    Estimate Std. Error z value Pr(&gt;|z|)    \n#&gt; ten - zero == 0       -40.3       24.9   -1.62     0.25    \n#&gt; twenty - zero == 0   -100.9       24.9   -4.06   &lt;0.001 ***\n#&gt; thirty - zero == 0   -130.2       24.9   -5.23   &lt;0.001 ***\n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; (Adjusted p values reported -- single-step method)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "ANOVA.html#含组间和组内因子的双因素方差分析",
    "href": "ANOVA.html#含组间和组内因子的双因素方差分析",
    "title": "\n7  方差分析\n",
    "section": "\n7.3 含组间和组内因子的双因素方差分析",
    "text": "7.3 含组间和组内因子的双因素方差分析\n\nCodedf &lt;- read_rds(\"data/repeated_measures_design_ANOVA.rds\")\n\nlibrary(nlme)\nmodel &lt;- lme(volume ~ method, random = ~1|id/Days, data = df,method = \"ML\")\nsummary(model)\n#&gt; Linear mixed-effects model fit by maximum likelihood\n#&gt;   Data: df \n#&gt;     AIC   BIC logLik\n#&gt;   373.9 384.8   -181\n#&gt; \n#&gt; Random effects:\n#&gt;  Formula: ~1 | id\n#&gt;         (Intercept)\n#&gt; StdDev:   0.0006732\n#&gt; \n#&gt;  Formula: ~1 | Days %in% id\n#&gt;         (Intercept) Residual\n#&gt; StdDev:        13.5  0.07035\n#&gt; \n#&gt; Fixed effects:  volume ~ method \n#&gt;                                 Value Std.Error DF t-value p-value\n#&gt; (Intercept)                     36.10     3.608 30  10.004  0.0000\n#&gt; methodSLAMF6- PD-1+ CD8+ cells  -3.23     5.102 12  -0.633  0.5386\n#&gt; methodSLAMF6+ PD-1+ CD8+ cells -20.31     5.102 12  -3.980  0.0018\n#&gt;  Correlation: \n#&gt;                                (Intr) mSLAMF6-PCc\n#&gt; methodSLAMF6- PD-1+ CD8+ cells -0.707            \n#&gt; methodSLAMF6+ PD-1+ CD8+ cells -0.707  0.500     \n#&gt; \n#&gt; Standardized Within-Group Residuals:\n#&gt;       Min        Q1       Med        Q3       Max \n#&gt; -0.007188 -0.003642 -0.001667  0.003564  0.013865 \n#&gt; \n#&gt; Number of Observations: 45\n#&gt; Number of Groups: \n#&gt;           id Days %in% id \n#&gt;           15           45\ndf_aov &lt;- anova(model)\ndf_aov\n\n\n\n\n\nnumDF\ndenDF\nF-value\np-value\n\n\n\n(Intercept)\n1\n30\n183.913\n0.0000\n\n\nmethod\n2\n12\n9.147\n0.0039\n\n\n\n\n\nCodelibrary(multcomp)\ndf_glht &lt;- glht(model, linfct = mcp(method = \"Tukey\")) \nsummary(df_glht)\n#&gt; \n#&gt;   Simultaneous Tests for General Linear Hypotheses\n#&gt; \n#&gt; Multiple Comparisons of Means: Tukey Contrasts\n#&gt; \n#&gt; \n#&gt; Fit: lme.formula(fixed = volume ~ method, data = df, random = ~1 | \n#&gt;     id/Days, method = \"ML\")\n#&gt; \n#&gt; Linear Hypotheses:\n#&gt;                                                          Estimate Std. Error\n#&gt; SLAMF6- PD-1+ CD8+ cells - PBS == 0                         -3.23       4.93\n#&gt; SLAMF6+ PD-1+ CD8+ cells - PBS == 0                        -20.31       4.93\n#&gt; SLAMF6+ PD-1+ CD8+ cells - SLAMF6- PD-1+ CD8+ cells == 0   -17.08       4.93\n#&gt;                                                          z value Pr(&gt;|z|)    \n#&gt; SLAMF6- PD-1+ CD8+ cells - PBS == 0                        -0.66   0.7894    \n#&gt; SLAMF6+ PD-1+ CD8+ cells - PBS == 0                        -4.12   &lt;0.001 ***\n#&gt; SLAMF6+ PD-1+ CD8+ cells - SLAMF6- PD-1+ CD8+ cells == 0   -3.46   0.0016 ** \n#&gt; ---\n#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n#&gt; (Adjusted p values reported -- single-step method)",
    "crumbs": [
      "统计推断",
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>方差分析</span>"
    ]
  },
  {
    "objectID": "SurvivalAnalysis.html",
    "href": "SurvivalAnalysis.html",
    "title": "8  生存分析",
    "section": "",
    "text": "8.1 Survival analysis\n医学研究中的生存数据建模",
    "crumbs": [
      "生存分析",
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>生存分析</span>"
    ]
  }
]